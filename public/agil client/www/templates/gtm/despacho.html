<div class="row">
	<div class="col-xs-12">
		<h3 class="header smaller lighter blue">REPORTE DE DESPACHOS</h3>
	</div>
	<div class="col-xs-12">
		<form name="formularioFiltroDespachos" novalidate ng-submit="paginator.getSearch(paginator.search,filtro,null)">
			<fieldset>
				<legend>Filtro de despachos
				</legend>

				<table class="table table-striped table-bordered table-hover">
					<tbody>
						<tr>
							<td>

							</td>
							<td>
								<label>Desde</label>&nbsp
							</td>
							<td>
								<label>Hasta</label>&nbsp
							</td>
							<td>
							</td>
							<td>
							</td>
						</tr>
						<tr>
							<td>
								<label>PERIODO</label>&nbsp
							</td>
							<td>
								<input required ng-update-hidden class="form-control date-picker" type="text" data-date-format="dd/mm/yyyy" id="fechainicio"
								 ng-model="filtro.inicio" placeholder="Ingrese la fecha inicial" />
							</td>
							<td>
								<input required ng-update-hidden class="form-control date-picker" type="text" data-date-format="dd/mm/yyyy" id="fechafin"
								 ng-model="filtro.fin" placeholder="Ingrese la fecha final" /> &nbsp
							</td>
							<td>
								<button type="submit" ng-disabled="formularioFiltroVentas.$invalid" class="btn btn-primary">
									<i class="ace-icon fa fa-plus align-top bigger-125"></i>
									Filtrar
								</button>
								<button id="pdf" class="btn btn-app btn-danger btn-xs" ng-click="imprimirPdfDespachos()">
									<i class="ace-icon fa fa-print bigger-160"></i>
									PDF
								</button>
								<button id="exel" class="btn btn-app btn-success btn-xs" ng-click="imprimirExelDespachos()">
									<i class="ace-icon fa fa-print bigger-160"></i>
									Excel
								</button>

							</td>
							<td>
								<div>Detalle
									<input name="switch-field-1" class="ace ace-switch ace-switch-4 ng-valid ng-dirty ng-valid-parse ng-not-empty ng-touched"
									 type="checkbox" ng-model="opcionBimonetario2">
									<span class="lbl check-descuento"></span>
								</div>
							</td>
						</tr>
						<tr>
							<td>
								&nbsp
							</td>
							<td>
								<label>Trasportista</label>&nbsp
							</td>
							<td>
								<label>Tipo de estibaje</label>&nbsp
							</td>
							<td>
								<label>Grupo de estibaje</label>&nbsp
							</td>
							<td>
								<label>Estado</label>&nbsp
							</td>
							<td>
								<label>Vendedor</label>&nbsp
							</td>
						</tr>
						<tr>
							<td>
								FILTRO
							</td>
							<td>
								<input type="text" ng-model="filtro.transportista">
							</td>
							<td>
								<input type="text" ng-model="filtro.tipo">
								<!-- <select id='id_tipo' ng-model='filtro.tipo_estibaje' data-placeholder="Click para escoger" class="col-sm5" ng-options="cuentaTipo.id as cuentaTipo.nombre for cuentaTipo in tiposComprobantes">
								<option value="">--ninguno--</option>
							</select> -->
							</td>
							<td>
								<input type="text" ng-model="filtro.grupo">
								<!-- <select id="sucursal" name="sucursal" ng-model="filtro.grupo_estibaje" data-placeholder="Elija una sucursal" ng-options="sucursalFiltro.id as sucursalFiltro.nombre for sucursalFiltro in sucursales">
								<option value="">--ninguno--</option>
							</select> -->
							</td>
							<td>
								<input type="text" ng-model="filtro.estado">
							</td>
							<td>
								<input type="text" ng-model="filtro.vendedor">
							</td>
						</tr>
					</tbody>
				</table>
			</fieldset>
		</form>
	</div>
	<div class="clearfix">
		<div class="pull-right tableTools-container"></div>
	</div>
	<!--<div class="fileUpload btn btn-primary btn-success">
			<span class="fileUpload-button ace-icon fa fa-cloud-upload align-top bigger-125">&nbsp&nbspImportar</span>
			<input ng-disabled="!aplicacion.puede_crear" class="upload" type="file" custom-on-file-change="subirExcelClientes" />&nbsp&nbsp
		</div>
		<a href="/recursos/EJEMPLO-DATOS-CLIENTES.xlsx" class="btn btn-primary btn-danger">
			<i class="ace-icon fa fa-cloud-download align-top bigger-125"></i>
			Ejemplo Importacion
		</a>
		<div class="clearfix">
			<div class="pull-right tableTools-container"></div>
		</div>-->
	<div class="table-header">
		Lista de Despachos
		<a class="green pull-right" href="javascript:void(0)" ng-click="abrirModalVentaKardexFactura()">
			<i class="ace-icon fa fa-unlock bigger-150"></i>
		</a>
	</div>

	<!-- div.table-responsive -->

	<!-- div.dataTables_borderWrap -->
	<div>
		<div class="dataTables_wrapper form-inline no-footer">
			<div class="row" ng-include src="'/templates/gral/paginator-header-1.html'">
			</div>

			<table id="tabla-destinos" class="table table-striped table-bordered table-hover">
				<thead>
					<tr>
						<th class="center">
							N°
						</th>
						<th>Fecha</th>
						<th>Vendedor</th>
						<th>Cliente</th>
						<th>S. Transporte</th>
						<th>Transportista</th>
						<th>Costo Transporte</th>
						<th>Grupo Estibaje</th>
						<th>Tipo Estibaje</th>
						<th>Costo Estibaje</th>
						<th>Factura</th>
						<th>Acciones</th>
					</tr>
				</thead>

				<tbody>
					<tr ng-repeat="gtm_detalle_despacho in despachos">
						<td class="center">
							{{$index+1}}
						</td>
						<td>{{gtm_detalle_despacho.fecha | date:"dd/MM/yyyy"}}</td>
						<td>{{gtm_detalle_despacho.despacho.usuario.persona.nombre_completo}}</td>
						<td>{{gtm_detalle_despacho.despacho.cliente.razon_social}}</td>
						<td>{{gtm_detalle_despacho.servicio_transporte}}</td>
						<td>{{gtm_detalle_despacho.transportista.persona.nombre_completo}}</td>
						<td>{{gtm_detalle_despacho.transportista.costo_transporte*gtm_detalle_despacho.cantidad_despacho}}</td>
						<td>{{gtm_detalle_despacho.grupo_estibaje.nombre}}</td>

						<td>{{gtm_detalle_despacho.estibaje.nombre}}</td>
						<td>{{gtm_detalle_despacho.estibaje.costo*gtm_detalle_despacho.cantidad_despacho}}</td>

						<td>{{gtm_detalle_despacho.factura}}</td>
						<td>
							<div class="hidden-sm hidden-xs action-buttons">
								<a class="blue" href="javascript:void(0)" ng-click="imprimir(gtm_detalle_despacho)">
									<i class="ace-icon fa fa-print bigger-130"></i>
								</a>

								<a class="green" href="javascript:void(0)" ng-click="abrirModalAsignacionFactura(gtm_detalle_despacho)">
									<i class="ace-icon fa fa-unlock bigger-130"></i>
								</a>

								<a class="red" href="javascript:void(0)" ng-click="abrirPopupConfirmacionEliminacion(removerDetalleDespacho,gtm_detalle_despacho)">
									<i class="ace-icon fa fa-trash-o bigger-130"></i>
								</a>

								<div class="hidden-md hidden-lg">
									<div class="inline pos-rel">
										<button class="btn btn-minier btn-yellow dropdown-toggle" data-toggle="dropdown" data-position="auto">
											<i class="ace-icon fa fa-caret-down icon-only bigger-120"></i>
										</button>

										<ul class="dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close">
											<li>
												<a href="javascript:void(0)" ng-click="imprimir(gtm_detalle_despacho)" class="tooltip-info" data-rel="tooltip" title="View">
													<span class="blue">
														<i class="ace-icon fa fa-printer bigger-120"></i>
													</span>
												</a>
											</li>

											<li>
												<a href="javascript:void(0)" ng-click="abrirModalAsignacionFactura(gtm_detalle_despacho)" class="tooltip-success" data-rel="tooltip"
												 title="Edit">
													<span class="green">
														<i class="ace-icon fa fa-unlock bigger-120"></i>
													</span>
												</a>
											</li>

											<li>
												<a href="javascript:void(0)" e-disabled="!aplicacion.puede_eliminar" ng-click="mostrarConfirmacionEliminacion(cliente)" class="tooltip-error"
												 data-rel="tooltip" title="Delete">
													<span class="red">
														<i class="ace-icon fa fa-trash-o bigger-120"></i>
													</span>
												</a>
									</div>
								</div>
						</td>
					</tr>
				</tbody>
			</table>
			<div class="row" ng-include src="'/templates/gral/paginator.html'" ng-if="despachos.length > 0">
			</div>
			</div>
		</div>
	</div>
</div>

<div id="modal-asignacion-factura">
	<div class="modal-header bg-primary">
		<h4 class='smaller text-white text-uppercase'>
			<label>Asignacion Factura</label>
		</h4>
	</div>
	<form name="asig" ng-submit="establecerFactura(detalle_despacho)">
		<div class="row">
			<div class="col-sm-12">
				<div class="form-group">
					<label for="ciudad">N° Factura</label>
					<input type="number" required ng-model="detalle_despacho.factura">
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-sm-12">
				<div class="modal-footer wizard-actions">
					<button ng-disabled="asig.$invalid" type="submit" class="btn btn-primary btn-sm">
						<i class="glyphicon glyphicon-floppy-disk"></i>Asignar
					</button>
					<button type="button" class="btn btn-danger btn-sm" ng-click="cerrarAsignacionFactura()">
						<i class="ace-icon fa fa-times"></i>Cancelar
					</button>
				</div>
			</div>
		</div>
	</form>
</div>
<div id="modal-asignacion-factura-kardex">
	<div class="modal-header bg-primary">
		<h4 class='smaller text-white text-uppercase'>
			<label>Asignacion Factura</label>
		</h4>
	</div>
	<form name="asig" ng-submit="establecerFacturaKardex(detalle_kardex)">
		<div class="row">
			<div class="col-sm-12">
				<div class="form-group">
					<label for="ciudad">N° Factura</label>
					<input type="number" required ng-model="detalle_kardex.factura">
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-sm-12">
				<div class="modal-footer wizard-actions">
					<button ng-disabled="asig.$invalid" type="submit" class="btn btn-primary btn-sm">
						<i class="glyphicon glyphicon-floppy-disk"></i>Asignar
					</button>
					<button type="button" class="btn btn-danger btn-sm" ng-click="cerrarAsignacionFacturaKardex()">
						<i class="ace-icon fa fa-times"></i>Cancelar
					</button>
				</div>
			</div>
		</div>
	</form>
</div>

<div id="modal-detalle-kardex">
	<div class="modal-header bg-primary">
		<h4 class='smaller text-white text-uppercase'>
			<label>Detalle</label>
		</h4>
	</div>
	<div class="modal-body">
		<p align="center">{{kardex.cliente.razon_social}}</p>
		<table class="table table-striped table-hover">
			<thead>
				<tr>
					<th>N°</th>
					<th>fecha</th>
					<th>producto</th>
					<th>cantidad</th>
					<th>P/U</th>
					<th>Total</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="hijoKardex in kardex.detalles_kardex[0].hijosDetalle track by $index">
					<td>{{$index+1}}</td>
					<td>{{hijoKardex.fecha |date:'dd/MM/yyyy'}}</td>
					<td>{{hijoKardex.producto.nombre}}</td>
					<td>{{hijoKardex.cantidad_despachada}}</td>
					<td>{{hijoKardex.producto.precio_unitario}}</td>
					<td>{{hijoKardex.cantidad*hijoKardex.producto.precio_unitario}}</td>

				</tr>

			</tbody>
		</table>
	</div>
	<div class="modal-footer wizard-actions">
		<button type="button" class="btn btn-primary btn-sm">
			<i class=" fa fa-print align-top "></i>
			Pdf
		</button>
		<button type="button" class="btn btn-danger btn-sm" ng-click="cerrarDetalleKardex()">
			<i class="ace-icon fa fa-times"></i>Cancelar
		</button>
	</div>
</div>
<div id="modal-venta-kardex-factura">
	<div class="modal-header bg-primary">
		<h4 class='smaller text-white text-uppercase'>
			<i class='icono-prerequisito'></i>
			<label> &nbsp;Factura Kardex </label>
		</h4>
	</div>
	<div class="modal-body">
		<form ng-submit="obtenerVentaKardexFactura(filtroVentaKardex)">
			<div class="row">
				<div class="form-group col-sm-3">
					<label for="nombres">Desde</label>
					<input type="text" class="form-control date-picker" autocomplete="off" ng-update-hidden ng-model="filtroVentaKardex.inicio"
					 data-date-format="dd/mm/yyyy" placeholder="Desde">
				</div>
				<div class="form-group col-sm-3">
					<label for="ap-paterno">Hasta</label>
					<input type="text" class="form-control date-picker" autocomplete="off" ng-update-hidden ng-model="filtroVentaKardex.fin"
					 data-date-format="dd/mm/yyyy" placeholder="Hasta">
				</div>
				<div class="form-group col-sm-2">

					<!-- <label>
						
					</label> -->

					<label>
						<b>Pendientes</b>
						<input ng-value="true" name="switch-field-1" autofocus class="ace ace-switch ace-switch-4 ng-pristine ng-untouched ng-valid ng-empty" type="checkbox"
						 ng-model="filtroVentaKardex.pendiente">
						<span class="lbl check-descuento"></span>
					</label>


				</div>
				<div class="form-group col-sm-4">
					<div class="buttons-align">
						<button type="submit" class="btn btn-primary btn-sm">
							<i class=" fa fa-search-plus align-top "></i>
							Filtrar
						</button>
					</div>
				</div>
			</div>
		</form>
		<div class="table-fixed-header">
			<table class="table table-striped table-bordered table-hover ">
				<thead fix-head class="table-head-color">
					<tr>
						<th>N°</th>
						<th>Fecha</th>
						<th>Usuario</th>
						<th>Cliente</th>
						<th>Monto</th>
						<th>Factura</th>
						<th>Acciones</th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="kardex in detalleKardexFactura track by $index">
						<td>{{$index+1}}</td>
						<td>{{kardex.fecha |date:'dd/MM/yyyy'}}</td>
						<td>{{kardex.usuario.persona.nombre_completo}}</td>
						<td>{{kardex.cliente.razon_social}}</td>
						<td>{{kardex.detalles_kardex[0].cantidad}}</td>
						<td>{{kardex.detalles_kardex[0].factura}}</td>
						<td>
							<a class="green" href="javascript:void(0)" ng-click="abrirModalAsignacionFacturaKardex(kardex)">
								<i class="ace-icon fa fa-unlock bigger-130"></i>
							</a>
							<a class="blue">
								<i class="ace-icon fa fa-folder-open bigger-130" ng-click="abrirModalDetalleKardex(kardex)"></i>
							</a>
						</td>
					</tr>

				</tbody>
			</table>
		</div>
	</div>
	<div class="modal-footer wizard-actions">
		<button class="btn btn-danger btn-sm" ng-click="cerrarVentaKardexFactura()">
			<i class="ace-icon fa fa-times"></i>Cancelar
		</button>
	</div>
</div>