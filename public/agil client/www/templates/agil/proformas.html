<div class="row">
    <div class="col-xs-12">
        <h3 class="header lighter blue">PROFORMAS</h3>
        <button id="nuevo" ng-disabled="!aplicacion.puede_crear" class="btn btn-primary" ng-click="abrirdialogProformaEdicion()">
            <i class="ace-icon fa fa-plus align-top bigger-125"></i>
            Nuevo
        </button>
        <button id="nuevo" ng-disabled="!aplicacion.puede_crear" class="btn btn-primary lighter blue" ng-click="abrirDialogPanelOperaciones()">
            <i class="ace-icon fa fa-key align-top bigger-150"></i>
            Llenar Tabla
        </button>
        <form name="formularioFiltroOperaciones" novalidate ng-submit="filtrarProformasOperaciones(filtro)">
            <fieldset>
                <legend>Filtro</legend>
                <table class="table table-striped table-bordered table-hover">
                    <tbody>
                        <tr>
                            <td>

                            </td>
                            <td>
                                <label>Mes</label>&nbsp
                            </td>
                            <td>
                                <label>Año</label>&nbsp
                            </td>
                            <td>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label>PERIODO</label>&nbsp
                            </td>
                            <td>
                                <select required id="mesFiltroProformas" name="mes" ng-options="mes as mes.nombre for mes in mesesFiltro track by mes.id"
                                    ng-model="filtro.mes">
                                    <option value="" selected>TODOS</option>
                                </select>

                            </td>
                            <td>
                                <select required id="anioFiltroProformas" name="anio" ng-options="anio as anio.nombre for anio in anios track by anio.id"
                                    ng-model="filtro.anio">
                                    <option value="" selected>TODOS</option>
                                </select> &nbsp
                            </td>
                            <td>
                                <button type="submit" class="btn btn-primary">
                                    <i class="ace-icon fa fa-search align-top bigger-125"></i>
                                    Filtrar
                                </button>
                            </td>
                            <td>
                                <a popover-trigger="outsideClick : outsideClick" uib-popover-template="PopoverConfiguracionActividad.templateUrl" popover-placement="left"
                                    class="btn button-config btn-primary" type="button" id="id-btn-ServiciosConfig">
                                    Configuración
                                    <i class=" glyphicon glyphicon-cog bigger-100"> </i>
                                </a>
                            </td>
                            <script type="text/ng-template" id="PopoverConfiguracionActividad.html">													
                               
                            <div class="form-control">                            
                                       <a href="javascript:void(0)" class="blue" ng-click="abrirConfiguracionActividades()">Actividad Economica</a>
                                   </div>
                                   <div class="form-control">   
                                       <a href="javascript:void(0)" class="blue" ng-click="abrirConfiguracionActividadesServicios()">Servicio</a>
                                   </div>
                                   <div class="form-control">   
                                        <a href="javascript:void(0)" class="blue" ng-click="abrirConfiguracionCentrosCostos()">Asignación centro costo</a>
                                    </div>
                              
                           </script>
                        </tr>
                        <tr>
                            <td>
                                &nbsp
                            </td>
                            <td>
                                <label>Razón Social</label>&nbsp
                            </td>
                            <td>
                                <label>Sucursal</label>&nbsp
                            </td>
                            <td>
                                <label>Monto</label>&nbsp
                            </td>
                            <td>
                                <label>Actividad económica</label>&nbsp
                            </td>
                        </tr>
                        <tr>
                            <td>
                                FILTRO
                            </td>
                            <td>
                                <input ng-model="filtro.razon" type="text">
                            </td>
                            <td>
                                <select id="sucursalFiltroProformas" name="sucursal" ng-options="sucursal as sucursal.nombre for sucursal in sucursales track by sucursal.id"
                                    ng-model="filtro.sucursal" ng-change="obtenerActividadesSucursal(filtro.sucursal.id)">
                                    <option value="" selected>TODOS</option>
                                </select>
                            </td>
                            <td>&nbsp
                                <input ng-model="filtro.monto" type="number">
                            </td>
                            <td style="max-width: 200px; width: 200px">
                                <select style="max-width: 180px;width: 180px" required id="actividadFiltroProformas" name="actividad" ng-change="obtenerServiciosActividadEmpresaPrincipal(filtro.actividadEconomica,true)"
                                    ng-options="actividad as actividad.actividad.nombre for actividad in actividadesEmpresa track by actividad.actividad.id"
                                    ng-model="filtro.actividadEconomica">
                                    <option value="" selected>TODOS</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                &nbsp
                            </td>
                            <td>
                                <label>Servicio</label>&nbsp
                            </td>
                            <td>&nbsp
                                <label>N° proforma</label>&nbsp
                            </td>
                            <td>
                                <label>Usuario</label>&nbsp
                            </td>
                            <td>
                                &nbsp
                            </td>
                        </tr>
                        <tr>
                            <td>
                            </td>
                            <td>
                                <div ng-if="filtro.actividadEconomica.id !==undefined">
                                    <select id="filtroServicio" ng-model="filtro.servicio" ng-change="" ng-options="servicio as servicio.nombre for servicio in filser track by servicio.id">
                                        <option value="" selected>TODOS</option>
                                    </select>
                                </div>
                                <div ng-if="filtro.actividadEconomica.id ===undefined">
                                    <select id="filtroServicio" ng-model="filtro.servicio">
                                        <option disabled selected value="">Seleccione una actividad</option>
                                    </select>
                                </div>
                            </td>
                            <td>&nbsp
                                <input ng-model="filtro.numero" type="number">
                            </td>
                            <td>
                                <input ng-model="filtro.usuario" type="text">&nbsp
                            </td>
                            <td>
                                <select id="filtroServicio" ng-model="filtro.proformaFacturadas" ng-change="" ng-options="opcion as opcion.nombre for opcion in [{id: 1, nombre: 'Facturados'}, {id: 2, nombre: 'Pendientes'}] track by opcion.id">
                                    <option value="" selected>TODOS</option>
                                </select>

                            </td>
                        </tr>
                    </tbody>
                </table>
            </fieldset>
        </form>
        <div class="clearfix">
            <div class="pull-right tableTools-container"></div>
        </div>
        <div class="table-header">
            Lista de Proformas
            <label class="pull-right">TOTAL BS. {{totalProformas | number:2}} &nbsp&nbsp $us. {{totalProformasDolar | number: 2}} &nbsp&nbsp</label>
        </div>
        <div id="tabla-pacientes_wrapper" class="dataTables_wrapper form-inline no-footer">
            <div class="row" ng-include src="'/templates/gral/paginator-header-2.html'">
            </div>
            <div style="overflow-x: scroll">
                <table id="tabla-ventas" class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>Nº</th>
                            <!-- <th>Movimiento</th> -->
                            <th>Prof.</th>
                            <th>Cliente</th>
                            <th>Periodo</th>
                            <th>Sucursal</th>
                            <th>Act. Eco.</th>
                            <th>Servicio</th>
                            <th>Usuario</th>
                            <th>Monto</th>
                            <th>Fecha Proforma</th>
                            <th>Fecha Recep.</th>
                            <th>Fecha Proforma ok</th>
                            <th>Fecha Factura</th>
                            <th>Fecha Cobro</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="{{proforma.color}}"  ng-repeat="proforma in proformas">
                            <td data-label="N°:">
                                {{($index+1)+(paginator.itemsPerPage*(paginator.currentPage-1))}}
                            </td>
                            <td>{{proforma.correlativo}}</td>
                            <td>{{proforma.cliente.razon_social}}</td>
                            <td>{{meses[proforma.periodo_mes].nombre}}/{{proforma.periodo_anio}}</td>
                            <td>{{proforma.sucursal.nombre}}</td>
                            <td>{{proforma.actividadEconomica.nombre}}</td>
                            <td>
                                {{proforma.detallesProformas[0].servicio.nombre}}
                            </td>
                            <td>{{proforma.usuarioProforma.nombre_usuario}}</td>
                            <td>{{proforma.totalImporteBs | number:2}}</td>
                            <td>{{proforma.fecha_proforma | date:"dd/MM/yyyy"}}</td>
                            <td>{{proforma.fecha_recepcion | date:"dd/MM/yyyy"}}
                                <div ng-if="((proforma.fecha_recepcion===undefined || proforma.fecha_recepcion===null) && !proforma.eliminado)">
                                    <a ng-disabled="!aplicacion.puede_modificar" class="orange" href="javascript:void(0)" ng-click="abrirdialogmodalFechas(proforma,0)">
                                        <i class="ace-icon fa fa-circle-o bigger-130"></i>
                                    </a>
                                </div>
                            </td>
                            <td>{{proforma.fecha_proforma_ok | date:"dd/MM/yyyy"}}
                                <div ng-if="((proforma.fecha_proforma_ok===undefined || proforma.fecha_proforma_ok===null) && !proforma.eliminado)">
                                    <a ng-disabled="!aplicacion.puede_modificar && proforma.eliminado" class="orange" href="javascript:void(0)" ng-click="abrirdialogmodalFechas(proforma,1)">
                                        <i class="ace-icon fa fa-circle-o bigger-130"></i>
                                    </a>
                                </div>
                            </td>
                            <td>{{proforma.fecha_factura | date:"dd/MM/yyyy"}}
                                <div ng-if="((proforma.fecha_factura===undefined || proforma.fecha_factura===null) && !proforma.eliminado)">
                                    <a ng-disabled="!aplicacion.puede_modificar" class="orange" href="javascript:void(0)" ng-click="abrirdialogmodalFechas(proforma,2)">
                                        <i class="ace-icon fa fa-circle-o bigger-130"></i>
                                    </a>
                                </div>
                            </td>
                            <td>{{proforma.fecha_cobro | date:"dd/MM/yyyy"}}
                                <div ng-if="((proforma.fecha_cobro===undefined || proforma.fecha_cobro===null) && !proforma.eliminado)">
                                    <a ng-disabled="!aplicacion.puede_modificar" class="orange" href="javascript:void(0)" ng-click="abrirdialogmodalFechas(proforma,3)">
                                        <i class="ace-icon fa fa-circle-o bigger-130"></i>
                                    </a>
                                </div>
                                <label class="bg-orange" ng-if="proforma.eliminado">&nbsp;ANULADO&nbsp;</label>
                            </td>
                            <td>
                                <div class="hidden-sm hidden-xs action-buttons">
                                    <a ng-if="!proforma.eliminado" ng-disabled="!aplicacion.puede_modificar" class="orange" href="javascript:void(0)" ng-click="editar(proforma)" data-rel="tooltip"
                                        tooltip-placement="top" uib-tooltip="Editar">
                                        <i class="ace-icon fa fa-pencil-square-o bigger-130"></i>
                                    </a>
                                    <a ng-if="!proforma.eliminado" popover-trigger="outsideClick : outsideClick" uib-popover-template="impresiones.templateUrl" popover-placement="left"
                                        data-rel="tooltip" tooltip-placement="left" uib-tooltip="Imprimir proforma" class="green"
                                        href="javascript:void(0)">
                                        <span class="ace-icon fa fa-print bigger-130"></span>
                                    </a>
                                    <script type="text/ng-template" id="impresiones.html">													
                                             <div class="form-control">                            
                                                        <a  class="blue" ng-click="imprimir(proforma,0)">Sin detalle</a>
                                                    </div>
                                                    <div class="form-control">   
                                                        <a  class="blue" ng-click="imprimir(proforma,1)">Con detalle</a>
                                                    </div>
                                                    <div class="form-control">   
                                                            <a  class="blue" ng-click="imprimir(proforma,2)">Mixta</a>
                                                        </div>
                                            </script>
                                    <a ng-disabled="!aplicacion.puede_ver" class="blue" href="javascript:void(0)" ng-click="ver(proforma)" data-rel="tooltip"
                                        tooltip-placement="top" uib-tooltip="Ver">
                                        <i class="ace-icon fa fa-search-plus bigger-130"></i>
                                    </a>
                                    <a ng-if="!proforma.eliminado" ng-disabled="!aplicacion.puede_eliminar" class="red" ng-click="abrirPopupConfirmacionEliminacion(eliminar,proforma)" data-rel="tooltip"
                                        tooltip-placement="top" uib-tooltip="Eliminar">
                                        <i class="ace-icon fa fa-trash-o bigger-130"></i>
                                    </a>
                                    <a ng-if="!proforma.eliminado" class="red" href="javascript:void(0)" ng-click="imprimirFactura(proforma)" data-rel="tooltip" tooltip-placement="left"
                                        uib-tooltip="Imprimir factura">
                                        <i class="ace-icon fa fa-print bigger-130"></i>
                                    </a>
                                </div>
                                <div class="hidden-md hidden-lg">
                                    <div class="inline pos-rel">
                                        <button class="btn btn-minier btn-yellow dropdown-toggle" data-toggle="dropdown" data-position="auto">
                                            <i class="ace-icon fa fa-caret-down icon-only bigger-120"></i>
                                        </button>
                                        <ul class="dropdown-menu dropdown-only-icon dropdown-yellow dropdown-menu-right dropdown-caret dropdown-close">
                                            <li ng-if="!proforma.eliminado">
                                                <a ng-disabled="!aplicacion.puede_modificar" class="orange" href="javascript:void(0)" ng-click="editar(proforma)">
                                                    <i class="ace-icon fa fa-pencil-square-o bigger-130"></i>
                                                </a>
                                            </li>
                                            <li ng-if="!proforma.eliminado">
                                                <a popover-trigger="outsideClick : outsideClick" uib-popover-template="impresiones.templateUrl" popover-placement="left"
                                                    class="green" href="javascript:void(0)">
                                                    <i class="ace-icon fa fa-print bigger-130" data-rel="tooltip" tooltip-placement="top" uib-tooltip="Imprimir"></i>
                                                </a>
                                                <script type="text/ng-template" id="impresiones.html">													
                                                            
                                                         <div class="form-control">                            
                                                                    <a  class="blue" ng-click="imprimir(proforma,0)">Sin detalle</a>
                                                                </div>
                                                                <div class="form-control">   
                                                                    <a  class="blue" ng-click="imprimir(proforma,1)">Con detalle</a>
                                                                </div>
                                                                <div class="form-control">   
                                                                        <a  class="blue" ng-click="imprimir(proforma,2)">Mixta</a>
                                                                    </div>
                                                           
                                                        </script>
                                            </li>
                                            <li>
                                                <a ng-disabled="!aplicacion.puede_ver" class="blue" href="javascript:void(0)" ng-click="ver(proforma)">
                                                    <i class="ace-icon fa fa-search-plus bigger-130"></i>
                                                </a>
                                            </li>
                                            <li ng-if="!proforma.eliminado">
                                                <a ng-disabled="!aplicacion.puede_eliminar" class="red" ng-if="solicitud.activo" ng-click="abrirPopupConfirmacionEliminacion(eliminar,proforma)">
                                                    <i class="ace-icon fa fa-trash-o bigger-130"></i>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="row" ng-include src="'/templates/gral/paginator.html'">
            </div>
        </div>
    </div>
</div>

<div id="modalConfiguracionActividadesServicios" style="overflow-x:hidden !important" class="modal wizard-posicion">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="formConfiguracionActividadesServicios" name="form" novalidate ng-submit="guardarConfiguracionActividadServicios(configuracionActividadServicio)">
                <div class="row">
                    <h2 align="center" class="blue">Servicios</h2>
                </div>
                <div id="modal-wizard-panel-container">
                    <div class="modal-header steps-container">
                        <!-- <div class="modal-header"> -->
                        <ul class="steps">
                            <li data-step="1" class="active">
                                <span class="step">
                                    <span class="glyphicon glyphicon-cog"></span>
                                </span>
                                <span class="title">SERVICIOS</span>
                            </li>
                            <li data-step="2">
                                <span class="step">
                                    <span class="fa fa-list-alt"></span>
                                </span>
                                <span class="title">Finalizar</span>
                            </li>
                        </ul>
                        <!-- </div> -->
                    </div>
                    <div class="modal-body step-content">
                        <div class="step-pane active" data-step="1">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="row form-group">
                                        <div class="col-lg-5">
                                            <label for="paterno">Actividades</label>
                                        </div>
                                        <div class="col-lg-7">
                                            <select style="max-width: 180px;width: 180px" ng-change="obtenerServiciosActividadEmpresaPrincipal(nActividad.actividadEconomica.actividad)"
                                                required id="actividadServicios" name="actividad" ng-options="actividad as actividad.actividad.nombre for actividad in actividadesEmpresaSinRepeticion track by actividad.actividad.id"
                                                ng-model="nActividad.actividadEconomica">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row form-group">
                                        <div class="col-lg-5">
                                            <label for="materno">Código</label>
                                        </div>
                                        <div class="col-lg-7">
                                            <input required ng-model="nActividad.servicio.codigo" type="text">
                                        </div>
                                    </div>
                                    <div class="row form-group">
                                        <div class="col-lg-5">
                                            <label for="materno">Servicio</label>
                                        </div>
                                        <div class="col-lg-7">
                                            <input required ng-model="nActividad.servicio.nombre" type="text">
                                        </div>
                                    </div>
                                    <div class="row form-group">
                                        <div class="col-lg-5">
                                            <label for="materno">Precio</label>
                                        </div>
                                        <div class="col-lg-7">
                                            <input required ng-model="nActividad.servicio.precio" type="number">
                                        </div>

                                    </div>
                                    <div class="row form-group">.
                                        <div class="container-fluid">
                                            <button type="button" class="btn btn-primary" ng-click="agregarDetalleActividadServicio(nActividad)">
                                                <i class="ace-icon fa fa-plus align-top bigger-125"></i>
                                            </button>
                                        </div>

                                    </div>
                                    <div class="row form-group">
                                        <div class="container-fluid">
                                            <table class="table table-striped table-bordered table-hover">
                                                <thead>
                                                    <th>Código</th>
                                                    <th>Servicios</th>
                                                    <th>Precio</th>
                                                    <th>Acciones</th>
                                                </thead>
                                                <tbody ng-if="!servicio.eliminado" ng-repeat="servicio in configuracionActividadServicio">
                                                    <td>
                                                        {{servicio.codigo}}
                                                    </td>
                                                    <td>
                                                        {{servicio.nombre}}
                                                    </td>
                                                    <td>
                                                        {{servicio.precio | number:2}}
                                                    </td>
                                                    <td>
                                                        <a e-disabled="!aplicacion.puede_eliminar" class="red" ng-click="abrirPopupConfirmacionEliminacion(eliminarDetalleConfiguracion,servicio)"
                                                            data-rel="tooltip" tooltip-placement="top" uib-tooltip="Eliminar">
                                                            <i class="ace-icon fa fa-trash-o bigger-130"></i>
                                                        </a>
                                                        <a e-disabled="!aplicacion.puede_modificar" class="blue" ng-click="editarServicio(servicio)" data-rel="tooltip" tooltip-placement="top"
                                                            uib-tooltip="Modificar">
                                                            <i class="ace-icon fa fa-pencil-square-o bigger-130"></i>
                                                        </a>
                                                    </td>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="step-pane" data-step="2">
                            <div class="center">
                                <h4 class="blue">Finalización</h4>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="modal-footer wizard-actions">

                    <!-- <button class="btn btn-sm btn-prev">
                        <i class="ace-icon fa fa-arrow-left"></i>
                        Anterior
                    </button> -->

                    <button id="siguienteP" ng-disabled="!aplicacion.puede_crear" class="btn btn-success btn-sm btn-next" data-last="Finish">
                        Siguiente
                        <i class="ace-icon fa fa-arrow-right icon-on-right"></i>
                    </button>

                    <button type="button" class="btn btn-danger btn-sm pull-left" data-dismiss="modal" ng-click="cerrarConfiguracionActividadesServicios()">
                        <i class="ace-icon fa fa-times"></i>
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="dialog-dosificar-actividad" title="¿Dosificar actividad?">
    <p>
        <span class="ui-icon ui-icon-alert" style="float:left; margin:0 7px 20px 0;"></span>¿Esta seguro de reemplazar la dosificación existente por una nueva?
    </p>
    <p>
        La dosificación anterior quedara cerrada y no podra ser usada para la emisión de nuevas facturas.
    </p>
    <button type="button" class="btn btn-danger" ng-click="dosificarSucursalActividad()">Si</button>
    <button type="button" class="btn btn-success" ng-click="cerrarconfirmarDosificacion()">No</button>
</div>

<div id="modalConfiguracionActividades" style="overflow-x:hidden !important" class="modal wizard-posicion">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="formConfiguracionActividadesEconomicas" name="form" novalidate ng-submit="guardarConfiguracionActividadEconomicas()">
                <div class="row">
                    <h2 align="center" class="blue">Actividades económicas</h2>
                </div>
                <div id="modal-wizard-panel-container-actividad">
                    <div class="modal-header steps-container">
                        <!-- <div class="modal-header"> -->
                        <ul class="steps">
                            <li data-step="1" class="active">
                                <span class="step">
                                    <span class="glyphicon glyphicon-cog"></span>
                                </span>
                                <span class="title">Actividades económicas</span>
                            </li>
                            <li data-step="2">
                                <span class="step">
                                    <span class="fa fa-list-alt"></span>
                                </span>
                                <span class="title">Finalizar</span>
                            </li>
                        </ul>
                        <!-- </div> -->
                    </div>
                    <div class="modal-body step-content">
                        <div class="step-pane active" data-step="1">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="row form-group">
                                        <div class="col-lg-4">
                                            <label for="paterno">Sucursal</label>
                                        </div>
                                        <div class="col-lg-5">
                                            <select style="max-width: 180px;width: 180px" required id="Sucursalactividad" name="Sucursalactividad" ng-change="obtenerActividadesSucursal(sucursalActividades.id)"
                                                ng-options="sucursal as sucursal.nombre for sucursal in sucursales track by sucursal.id"
                                                ng-model="sucursalActividades">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row form-group">
                                        <div class="col-lg-4">
                                            <label for="paterno">Actividades</label>
                                        </div>
                                        <div class="col-lg-5">
                                            <select style="max-width: 180px;width: 180px" required id="actividadSucursal" name="actividad" ng-options="actividad as actividad.nombre for actividad in actividades track by actividad.id"
                                                ng-model="actividadEconomicaEmpresa">
                                            </select>
                                        </div>
                                        <div class="col-lg-2">
                                            <button type="button" class="btn btn-primary" ng-click="agregarDetalleActividadEmpresa(sucursalActividades,actividadEconomicaEmpresa)">
                                                <i class="ace-icon fa fa-plus align-top bigger-125"></i>
                                            </button>
                                        </div>
                                    </div>

                                    <!-- <div class="row form-group">
                                        
                                    </div> -->
                                    <div class="row form-group">
                                        <div class="container-fluid">
                                            <table class="table table-striped table-bordered table-hover">
                                                <thead>
                                                    <th>Actividades</th>
                                                    <th>Dosificación</th>
                                                    <th>Acciones</th>
                                                </thead>
                                                <tbody>
                                                    <tr ng-if="!actividad.expirado" ng-repeat="actividad in actividadesDosificaciones track by $index">
                                                        <td>
                                                            {{actividad.actividad.nombre}}
                                                            <span ng-if="actividad.eliminado" style="color: red">SE ELIMINARA</span>
                                                        </td>
                                                        <td>
                                                            {{actividad.dosificacion.autorizacion}}
                                                            <span ng-if="actividad.dosificacion.expirado" style="color: red">EXPIRADO</span>
                                                        </td>
                                                        <td>
                                                            <!-- <a ng-disabled="!aplicacion.puede_eliminar" class="blue" ng-click="sinFuncionalidad()" data-rel="tooltip" tooltip-placement="top"
                                                                uib-tooltip="Historial Dosificaciones">
                                                                <i class="ace-icon fa fa-book"></i>
                                                            </a> -->

                                                            <a ng-disabled="!aplicacion.puede_modificar" class="green" ng-click="abrirdialogDosificacionesDisponibles(actividad)" data-rel="tooltip"
                                                                tooltip-placement="top" uib-tooltip="Dosificar">
                                                                <i class="fa fa-hand-o-up"></i>
                                                            </a>

                                                            <a ng-disabled="!aplicacion.puede_eliminar" class="red" ng-click="mostarMensajeConfirmacionEliminacionActividad(actividad)"
                                                                data-rel="tooltip" tooltip-placement="top" uib-tooltip="Eliminar">
                                                                <i class="ace-icon fa fa-trash-o bigger-130"></i>
                                                            </a>
                                                            <a ng-click="obtenerHistorialActividad(actividad)" popover-trigger="outsideClick : outsideClick" popover-append-to-body="true"
                                                                popover-title="Historial" uib-popover-template="PopoverConfiguracionActividadhistorial.templateUrl"
                                                                popover-placement="top" class="btn button-config btn-minier"
                                                                type="button" id="id-btn-historialDosificacion">
                                                                H
                                                            </a>
                                                            <script type="text/ng-template" id="PopoverConfiguracionActividadhistorial.html">
                                                                
                                                                    <table class="table table-striped table-bordered table-hover ">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>
                                                                                    N°
                                                                                </th>
                                                                                <th>
                                                                                    autorizacion
                                                                                </th>
                                                                                <th>
                                                                                    Correlativo
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr ng-repeat="actividadd in historialActividad track by $index">
                                                                                <td>
                                                                                    {{$index+1}}
                                                                                </td>
                                                                                <td>
                                                                                    {{actividadd.dosificacion.autorizacion}}
                                                                                    <span ng-if="actividadd.dosificacion.expirado" style="color: red">EXPIRADO</span>
                                                                                </td>
                                                                                <td>
                                                                                    {{actividadd.dosificacion.correlativo}}
                                                                                </td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                          
                                                     
                                                            </script>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="step-pane" data-step="2">
                            <div class="center">
                                <h4 class="blue">Finalización</h4>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="modal-footer wizard-actions">

                    <!-- <button class="btn btn-sm btn-prev">
                            <i class="ace-icon fa fa-arrow-left"></i>
                            Anterior
                        </button> -->

                    <button ng-disabled="!aplicacion.puede_crear" id="siguiente-wizard-configuracion-proforma" class="btn btn-success btn-sm btn-next"
                        data-last="Finish">
                        Siguiente
                        <i class="ace-icon fa fa-arrow-right icon-on-right"></i>
                    </button>

                    <button type="button" class="btn btn-danger btn-sm pull-left" data-dismiss="modal" ng-click="cerrarConfiguracionActividades()">
                        <i class="ace-icon fa fa-times"></i>
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="proforma-edicion" style="overflow-x:hidden !important" class="modal wizard-posicion">
    <div class="row">
        <div class="col-sm-4">
            <div class="widget-box">
                <form id="formularioProforma" name="formularioProforma" novalidate ng-submit="guardarProforma(formularioProforma.$valid,proforma)">
                    <div class="widget-header">
                        <h4 class="widget-title">DATOS DE PROFORMA</h4>
                        &nbsp;
                        <div class="row">
                            |<button tabindex="-1" ng-disabled="(proforma.ver !== undefined || detallesProformas.length==0)" id="guardarProforma" type="submit"
                            class="btn btn-primary">
                            <i class="ace-icon fa fa-floppy-o align-top bigger-125"></i>
                            GUARDAR
                            </button>
                            <button tabindex="-1" id="cerrarV" type="button" class="btn btn-primary btn-danger" ng-click="cerrardialogProformaEdicion()">
                            <i class="ace-icon fa fa-times red2 align-top bigger-125"></i>
                            CERRAR
                            </button>
                        </div>
                    </div>
                    <div class="widget-body">
                        <div class="widget-main">
                            <table class="table table-striped table-bordered table-hover">
                                <tr>
                                    <td>
                                        <div class="row">
                                            <div class="container-fluid">
                                                <label>SUCURSAL</label>
                                                <div ng-if="(!verificarBloqueoServicios())">
                                                    <select class="form-control" data-validate="validate(required)" required id="sucursal" name="sucursal" ng-options="sucursal as sucursal.nombre for sucursal in sucursales track by sucursal.id"
                                                    ng-disabled="(proforma.ver !== undefined || $scope.verificarDetallesProformas())" ng-model="proforma.sucursal" ng-change="obtenerActividadesSucursal(proforma.sucursal.id)">
                                                        <option value="" disabled selected>Selec. Sucursal</option>
                                                    </select>
                                                </div>
                                                <div ng-if="(verificarBloqueoServicios())">
                                                    <select class="form-control" data-validate="validate(required)" required id="sucursalProformaDisabled" name="sucursal" ng-options="sucursal as sucursal.nombre for sucursal in sucursales track by sucursal.id"
                                                        ng-model="proforma.sucursal" disabled>
                                                        <option value="" disabled selected>Selec. Sucursal</option>
                                                    </select>
                                                </div>

                                                <span class="red">(*)</span>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="row">
                                            <div class="container-fluid">
                                                <div class="">
                                                    <label>ACTIVIDAD</label>
                                                </div>
                                                <div ng-if="(!verificarBloqueoServicios())">
                                                    <select autofocus class="form-control" style="width:150px;" data-validate="validate(required)" ng-change="obtenerServiciosActividadEmpresaPrincipal(proforma.actividadEconomica)"
                                                        required id="actividadProforma" name="actividad" ng-model="proforma.actividadEconomica"
                                                        ng-options="actividad as actividad.nombre for actividad in actividadesSucursal track by actividad.id" ng-disabled="(proforma.ver !== undefined || $scope.verificarDetallesProformas())"
                                                        data-placeholder="Click para escoger">
                                                        <option value="" disabled selected>Selec. Actividad</option>
                                                    </select>
                                                    <span class="red">(*)</span>
                                                    <span ng-if="dosificacionesExpiradas" style="color: red">Las Actividades con dosificaciones expiradas no se muestran</span>
                                                </div>
                                                <div ng-if="(verificarBloqueoServicios())">
                                                    <select class="form-control" data-validate="validate(required)" required id="actividadProformaDisable" name="actividad" ng-model="proforma.actividadEconomica"
                                                        disabled ng-options="actividad as actividad.nombre for actividad in actividadesSucursal track by actividad.id"
                                                        data-placeholder="Click para escoger">
                                                    </select>
                                                    <span class="red">(*)</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="invalid-message help-block" ng-messages="formularioProforma.actividad.$error" ng-if=" (formularioProforma.$submitted && formularioProforma.actividad.$invalid)">
                                            <div ng-messages-include="/templates/gral/messages.html"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label>RAZÓN SOCIAL CLIENTE</label>
                                        <div ng-if="(!verificarBloqueoServicios())">
                                                <input ng-disabled="($scope.verificarDetallesProformas())" ng-keypress="interceptarTecla($event,'proformaDetalle',true)" autocomplete="off"
                                                data-validate="validate(required)" id="razon_social" name="razon_social" required
                                                type="text" ng-model="proforma.cliente.razon_social" placeholder="Ingrese la Razon Social"
                                                uib-typeahead="cliente as cliente.razon_social for cliente in buscarCliente($viewValue)"
                                                typeahead-wait-ms="2000" typeahead-template-url="templates/autocompletar.html" typeahead-show-hint="false"
                                                typeahead-min-length="0" typeahead-on-select="establecerCliente($item, $model, $label, $event)">
                                        </div>
                                        <div ng-if="(verificarBloqueoServicios())">
                                                <input autocomplete="off"
                                                data-validate="validate(required)" id="razon_socialDisabled" name="razon_social" required
                                                type="text" ng-model="proforma.cliente.razon_social" disabled>
                                        </div>
                                        
                                        <span class="red">(*)</span>
                                        <button tabindex="-1" ng-disabled="($scope.verificarDetallesProformas())" id="mostrar_clientes_proforma" type="button" ng-click="abrirdialogClientesProforma()"
                                            class="btn btn-info btn-sm">
                                            <i class="ace-icon fa fa-search-plus bigger-110"></i>
                                        </button>
                                        <!-- <span class="invalid-message" ng-show="formularioProforma.razon_social.$dirty && formularioProforma.razon_social.$invalid">
                                            Dato requerido.
                                        </span> -->
                                    </td>
                                    <td>
                                        <label>NIT CLIENTE</label>
                                        <div ng-if="(!verificarBloqueoServicios())">
                                                <input ng-disabled="($scope.verificarDetallesProformas())" ng-keypress="interceptarTecla($event,'proformaDetalle',true)" data-validate="validate(required)"
                                                id="nit" name="nit" required type="number" min="0" ng-model="proforma.cliente.nit"
                                                placeholder="Ingrese el NIT" uib-typeahead="cliente as cliente.nit for cliente in buscarCliente($viewValue)"
                                                typeahead-wait-ms="2000" typeahead-template-url="templates/autocompletar.html" typeahead-show-hint="false"
                                                typeahead-min-length="0" typeahead-on-select="establecerCliente($item, $model, $label, $event)">
                                        </div>
                                        <div ng-if="(verificarBloqueoServicios())">
                                                <input
                                                id="nit" name="nit" required type="number" min="0" ng-model="proforma.cliente.nit" disabled
                                                >
                                        </div>
                                        <span class="red">(*)</span>
                                        <!-- <span class="invalid-message" ng-show="formularioProforma.nit.$dirty && formularioProforma.nit.$invalid">
                                                Debe ingresar un número mayor o igual a 0.
                                            </span> -->

                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <div class="container-fluid">

                                            <label class="row">DETALLE</label>


                                            <textarea ng-disabled="proforma.ver !== undefined" class="form-control" row="3" required name="detalle" id="proformaDetalle" ng-keypress="interceptarTecla($event,'id_servicioProforma',true)"
                                                ng-model="proforma.detalle"></textarea>
                                            <span class="red">(*)</span>
                                            <!-- <span class="invalid-message" ng-show="formularioProforma.detalle.$dirty && formularioProforma.detalle.$invalid">
                                                Detalle es un dato requerido.
                                            </span> -->
                                        </div>
                                    </td>
                                    <div class="col-md-4">
                                        <label for="">Tipo de cambio.</label>
                                        <label for="">{{moneda.dolar}}</label>
                                    </div>
                                </tr>
                                <tr>
                                    <td>
                                        <label>FECHA</label>
                                        <!--  <input name="fecha" required class="form-control" type="date" id="fecha" ng-model="proforma.fecha" ng-change="actualizarPeriodo(proforma.fecha)"
                                        /> -->
                                        <input ng-disabled="proforma.ver !== undefined" ng-update-hidden ng-change="actualizarPeriodo(proforma.fecha_proforma)" type="text"
                                            data-date-format="dd/mm/yyyy" class="form-control date-picker" id="fecha-inicial"
                                            ng-update-hidden ng-model="proforma.fecha_proforma" name="fecha-inicial" value="{{proforma.fecha_proforma | date: dd/MM/yy}}">
                                        <span class="red">(*)</span>
                                        <!-- <span class="invalid-message" ng-show="formularioProforma.fecha.$dirty && formularioProforma.fecha.$invalid">
                                            Dato requerido.
                                        </span> -->
                                    </td>
                                    <td>
                                        <div class="container-fluid">
                                            <div class="row">
                                                <label>PERIODO</label>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <select ng-disabled="proforma.ver !== undefined" required id="mes" name="mes" ng-options="mes as mes.nombre for mes in meses track by mes.id"
                                                            ng-model="proforma.periodo_mes">
                                                            <option disabled value="" selected>Mes</option>
                                                        </select>

                                                    </div>
                                                    <div class="col-md-6">
                                                        <select ng-disabled="proforma.ver !== undefined" required id="anio" name="anio" ng-options="anio as anio.nombre for anio in anios track by anio.id"
                                                            ng-model="proforma.periodo_anio">
                                                            <option disabled value="" selected>Año</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <span class="red">(*)</span>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <!-- <td> -->
                                    <!-- <div class="col-md-6">
                                                <label>Detalle</label>
                                        </div>
                                        <div class="col-md-6">
                                        <textarea row="3" name="detalle" id="proformaDetalle" ng-model="proforma.detalle"></textarea><span class="red">(*)</span>                                        
                                        </div> -->


                                    <!-- </td> -->
                                    <!-- <td>
                                        <label>SUJETO A CF</label>
                                        <input disabled type="number" step="0.001" ng-model="proforma.total" />
                                    </td> -->
                                </tr>
                            </table>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="col-sm-8">
            <div class="widget-box">
                <div class="widget-header">
                    <h4 class="widget-title">BUSQUEDA SERVICIO</h4>
                </div>
                <div class="widget-body">
                    <div class="widget-main">
                        <form id="formularioBusquedaServicio" name="formularioBusquedaServicio" novalidate>
                            <table class="table table-striped table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th>
                                            <label>SERVICIO</label>
                                        </th>
                                        <th>
                                            <label>CÓD. ITEM</label>
                                        </th>
                                        <th>
                                            <label>CANT. (u)</label>
                                        </th>
                                        <th>
                                            <label>P.U. (Bs/u)</label>
                                        </th>
                                        <th>
                                            <label>P.U. ($us/u)</label>
                                        </th>
                                        <th>
                                            <label>IMP. (Bs)</label>
                                        </th>
                                        <th>
                                            <label>IMP. ($us)</label>
                                        </th>
                                        <th>
                                            <label>Centro Costos</label>
                                        </th>
                                        <th>
                                            <label>ACC.</label>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <input ng-disabled="proforma.ver" autocomplete="off" ng-keypress="interceptarTecla($event,'cantidad',true)"
                                                id="id_servicioProforma" required type="text" ng-model="detalleProforma.servicio.nombre"
                                                placeholder="Ingrese el nombre del servicio..." uib-typeahead="servicio as (servicio.codigo+' - '+servicio.nombre) for servicio in buscarservicio($viewValue)"
                                                typeahead-wait-ms="1000" typeahead-template-url="templates/autocompletar.html"
                                                typeahead-show-hint="false" typeahead-min-length="1" typeahead-on-select="establecerservicio($item, $model, $label, $event)">
                                            <div class="space-6"></div>
                                            <button ng-disabled="(facturaProformas.ver || proforma.actividadEconomica === undefined)" id="mostrar_servicios_proforma"
                                                type="button" ng-click="abrirBusquedaServiciosProforma(proforma.actividadEconomica)"
                                                class="btn btn-info btn-sm">
                                                <i class="ace-icon fa fa-search-plus bigger-110"></i>
                                            </button>
                                        </td>
                                        <td>
                                            {{detalleProforma.servicio.codigo}}
                                        </td>
                                        <td>
                                            <input ng-disabled="proforma.ver !== undefined" onfocus="this.select();" ng-keypress="interceptarTecla($event,'agregar_detalle_asignacion_centro_costo',false)"
                                                id="cantidad" name="cantidad" step="1" min="1" required class="col-xs-12" ng-change="calcularImporte()"
                                                ng-model="detalleProforma.cantidad" type="number" />
                                        </td>
                                        <td ng-if="detalleProforma.editarPrecio === undefined">
                                            {{detalleProforma.precio_unitario | number:2}}
                                            <a ng-if="detalleProforma.precio_unitario >=0" ng-disabled="proforma.ver !== undefined" class="green" href="javascript:void(0)"
                                                ng-click="modificarProformaPrecioUnitarioServicio(detalleProforma)">
                                                <i class="ace-icon fa fa-pencil-square-o bigger-130"></i>
                                            </a>

                                        </td>
                                        <td ng-if="detalleProforma.editarPrecio !== undefined">
                                            <input ng-disabled="proforma.ver !== undefined" onfocus="this.select();" id="edicion" name="cantidad" step="0.01" min="0.01"
                                                required class="col-xs-12" ng-change="calcularImporte()" ng-model="detalleProforma.precio_unitario"
                                                type="number" />
                                        </td>
                                        <td ng-if="detalleProforma.editarPrecio === undefined">
                                            {{detalleProforma.precioSus | number:2}}
                                            <a ng-if="detalleProforma.precioSus >=0" ng-disabled="proforma.ver !== undefined" class="green" href="javascript:void(0)"
                                                ng-click="modificarProformaPrecioUnitarioServicio(detalleProforma)">
                                                <i class="ace-icon fa fa-pencil-square-o bigger-130"></i>
                                            </a>
                                        </td>
                                        <td ng-if="detalleProforma.editarPrecio !== undefined">
                                            <input ng-disabled="proforma.ver !== undefined" onfocus="this.select();" id="edicion" name="cantidad" step="0.01" min="0.01"
                                                required class="col-xs-12" ng-change="calcularImporte(true)" ng-model="detalleProforma.precioSus"
                                                type="number" />
                                        </td>
                                        <td>
                                            {{detalleProforma.importe | number:2}}
                                        </td>
                                        <td>
                                            {{detalleProforma.importeSus | number:2}}
                                        </td>
                                        <td> 
                                            <select ng-disabled="proforma.ver" required id="centroCosto" name="centroCosto" ng-options="centroCosto as centroCosto.nombre for centroCosto in listaCentroCostosClienteEmpresaPro track by centroCosto.id"
                                                ng-model="detalleProforma.centroCosto">
                                            </select>
                                            <a href="javascript:void(0)" ng-if="proforma.cliente" ng-click="abrirConfiguracionCentrosCostos(proforma.cliente)"><i class="blue ace-icon fa fa-pencil-square-o bigger-130"></i></a>
                                            <!-- <select ng-disabled="proforma.ver !== undefined" required id="centroCosto" name="centroCosto" ng-options="centroCosto as centroCosto.nombre for centroCosto in centroCostos track by centroCosto.id"
                                                ng-model="detalleProforma.centroCosto">
                                            </select> -->
                                        </td>
                                        <td>
                                            <button ng-disabled="proforma.ver" id="agregar_detalle_asignacion_centro_costo" type="button" ng-disabled="formularioBusquedaservicio.$invalid"
                                                ng-click="agregardetalleProforma(detalleProforma)" class="btn btn-success btn-sm">
                                                <i class="ace-icon fa fa-plus bigger-110"></i>
                                            </button>
                                            <!-- <div class="space-6"></div>
                                            <button id="mostrar_desc" type="button" ng-click="mostrarDescuentos()" class="btn btn-info btn-sm">
                                                <i class="ace-icon fa fa-exchange bigger-110"></i>
                                            </button> -->
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </form>
                    </div>
                </div>
            </div>
            <div class="widget-box">
                <div class="widget-header" ng-if="detallesProformas.length>0">
                    <div class="row">
                        <div class="col-sm-6">
                            <h4 class="widget-title">DETALLE DE PROFORMA</h4>
                        </div>
                    </div>
                    <div class="row">
                        <div class="container-fluid">
                            <b>Total Bs: {{proforma.totalImporteBs | number:2}} &nbsp &nbsp Total $us: {{proforma.totalImporteSus
                                | number:2}}&nbsp &nbsp &nbsp Son:&nbsp&nbsp{{proforma.importeLiteral}} </b>
                        </div>
                    </div>
                </div>
                <div class="widget-body" ng-if="detallesProformas.length>0">
                    <div class="widget-main">
                        <table class="table table-striped table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th>
                                        <label>#</label>
                                    </th>
                                    <th>
                                        <label>NOMBRE</label>
                                    </th>
                                    <th>
                                        <label>CÓD. ITEM</label>
                                    </th>
                                    <th>
                                        <label>P.U. (Bs/u)</label>
                                    </th>
                                    <th>
                                        <label>P.U. ($us/u)</label>
                                    </th>
                                    <th>
                                        <label>CANT. (u)</label>
                                    </th>
                                    <th>
                                        <label>IMP. (Bs)</label>
                                    </th>
                                    <th>
                                        <label>IMP. ($us)</label>
                                    </th>
                                    <th>
                                        <label>Centro Costos</label>
                                    </th>
                                    <th>
                                        <label>ACCIONES</label>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-if="!detalle.eliminado" ng-repeat="detalle in detallesProformas">
                                    <td>
                                        {{$index+1}}
                                    </td>
                                    <td>
                                        {{detalle.servicio.nombre}}
                                    </td>
                                    <td>
                                        {{detalle.servicio.codigo}}
                                    </td>
                                    <td>
                                        {{detalle.precio_unitario | number:2}}
                                    </td>
                                    <td>
                                        {{detalle.precioSus | number:2}}
                                    </td>
                                    <td>
                                        {{detalle.cantidad}}
                                    </td>
                                    <td>
                                        {{detalle.importe| number:2}}
                                    </td>
                                    <td>
                                        {{detalle.importeSus | number:2}}
                                    </td>
                                    <td>
                                        {{detalle.centroCosto.nombre}}
                                    </td>

                                    <td>
                                        <a e-disabled="proforma.ver" class="red" href="javascript:void(0)" ng-click="abrirPopupConfirmacionEliminacion(eliminarDetalleProforma,detalle)">
                                            <i class="ace-icon fa fa-trash-o bigger-130"></i>
                                        </a>
                                        <a e-disabled="proforma.ver" class="blue" href="javascript:void(0)" ng-click="editarDetalleProforma(detalle)">
                                                <i class="ace-icon fa fa-pencil-square-o bigger-130"></i>
                                            </a>
                                    </td>
                                </tr>
                                <tr>
                                    <td>

                                    </td>
                                    <td>
                                        <b>TOTALES</b>
                                    </td>
                                    <td>

                                    </td>
                                    <td>

                                    </td>
                                    <td>

                                    </td>
                                    <td>

                                    </td>
                                    <td>
                                        <b>{{proforma.totalImporteBs | number:2}}</b>
                                    </td>
                                    <td>
                                        <b>{{proforma.totalImporteSus | number:2}}</b>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="dialog-Busqueda-servicio-proforma" style="overflow-x:hidden;">
    <div class="row">
        <div class="widget-header">
            <div class="container-fluid">
                <div class="col-md-8">
                    <label>Búsqueda:
                        <input focus tabindex="1" type="search" class="form-control input-sm" ng-model="textoBusquedaServicio" ng-change="filtrarServicios(textoBusquedaServicio)">
                    </label>
                </div>
                <div class="col-md-4">
                    <button type="button" ng-click="cerrarBusquedaServiciosProforma()" class="btn btn-danger">
                        <i class="ace-icon fa fa-close align-top bigger-125"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="container-fluid">
            <div class="widget-box">
                <div class="widget-body">
                    <div class="widget-main">
                        <div class="table-fixed-header">
                            <table class="table table-striped table-bordered table-hover ">
                                <thead fix-head class="table-head-color">
                                    <tr>
                                        <th>
                                            <label for="">N°</label>
                                        </th>
                                        <th>
                                            <label for="">
                                                Código
                                            </label>
                                        </th>
                                        <th>
                                            Nombre
                                        </th>
                                        <th>
                                            Precio
                                        </th>
                                        <th>
                                            Acciones
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="servicio in serviciosProcesados">
                                        <td>
                                            {{$index+1}}
                                        </td>
                                        <td>
                                            {{servicio.codigo}}
                                        </td>
                                        <td>
                                            {{servicio.nombre}}
                                        </td>
                                        <td>
                                            {{servicio.precio}}
                                        </td>
                                        <td>
                                            <a tabindex="{{$index+2}}" href="javascript:void(0)" ng-click="establecerservicio(servicio,true)" ng-keypress="interceptarTecla($event,'agregar_detalle_venta',false)">SELECCIONAR</a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>


<div id="dialog-cliente-proforma" style="overflow-x:hidden;">
    <div class="row">
        <div class="widget-header">
            <div class="container-fluid">
                <div class="col-md-8">
                    <label>Búsqueda:
                        <input focus tabindex="1" type="search" class="form-control input-sm" ng-model="textoBusqueda" ng-change="filtrarClientes(textoBusqueda)">
                    </label>
                </div>
                <div class="col-md-4">
                    <button type="button" ng-click="cerrardialogClientesProforma()" class="btn btn-danger">
                        <i class="ace-icon fa fa-close align-top bigger-125"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="container-fluid">
            <div class="widget-box">
                <div class="widget-body">
                    <div class="widget-main">
                        <div class="table-fixed-header">
                            <table class="table table-striped table-bordered table-hover ">
                                <thead fix-head class="table-head-color">
                                    <tr>
                                        <th>
                                            <label for="">N°</label>
                                        </th>
                                        <th>
                                            <label for="">
                                                Razon social
                                            </label>
                                        </th>
                                        <th>
                                            NIT
                                        </th>
                                        <th>
                                            Acciones
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="cliente in clientesProcesados">
                                        <td>
                                            {{$index+1}}
                                        </td>
                                        <td>
                                            {{cliente.razon_social}}
                                        </td>
                                        <td>
                                            {{cliente.nit}}
                                        </td>
                                        <td>
                                            <a tabindex="{{$index+2}}" href="javascript:void(0)" ng-keypress="interceptarTecla($event,'agregar_detalle_venta',false)" ng-click="seleccionarcliente(cliente)">SELECCIONAR</a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<div id="modalFechas" style="overflow-x:hidden !important" class="modal wizard-posicion">
    <div class="modal-dialog">
        <div class="modal-content">
            <form name="formularioFiltroOperaciones" novalidate ng-submit="actualizarFechas(proformaFechas)">
                <div class="row">
                    <h2 align="center" class="blue">FECHAS</h2>
                </div>
                <div id="modal-wizard-panel-container">
                    <div class="modal-header steps-container">
                        <!-- <div class="modal-header"> -->
                        <ul class="steps">
                            <li data-step="1" class="active">
                                <span class="step">
                                    <span class="glyphicon glyphicon-cog"></span>
                                </span>
                                <span class="title">FECHAS</span>
                            </li>
                            <li data-step="2">
                                <span class="step">
                                    <span class="fa fa-list-alt"></span>
                                </span>
                                <span class="title">Finalizar</span>
                            </li>
                        </ul>
                        <!-- </div> -->
                    </div>
                    <br>
                    <div class="row">
                        <div class="container-fluid">
                            <div class=" form-group">
                                <input autofocus hidden type="text" id="autohidden">
                                <div class="col-md-4">
                                    <label for="">Recepcion</label>
                                </div>
                                <div class="col-md-8">
                                    <input autocomplete="off" ng-update-hidden type="text" data-date-format="dd/mm/yyyy" class="form-control date-picker" id="fecha-recepcion"
                                        ng-model="proformaFechas.fecha_recepcion" name="fecha-recepcion">
                                </div>
                            </div>
                            <div class=" form-group">
                                <div class="col-md-4">
                                    <label for="">Proforma Ok</label>

                                </div>
                                <div class="col-md-8">
                                    <input autocomplete="off" ng-disabled="verificarFechaRecepcion(proformaFechas.fecha_recepcion)" ng-change="compararFechasProformas(proformaFechas.fecha_recepcion,proformaFechas.fecha_proforma_ok)"
                                        ng-update-hidden type="text" data-date-format="dd/mm/yyyy" class="form-control date-picker"
                                        id="fecha-proformaOk" ng-model="proformaFechas.fecha_proforma_ok" name="fecha-proformaOk">
                                </div>

                            </div>
                            <div class=" form-group">
                                <div class="col-md-4">
                                    <label for="">Factura</label>
                                </div>
                                <div class="col-md-8">
                                    <input disabled autocomplete="off" ng-change="compararFechasProformas(proformaFechas.fecha_proforma_ok,proformaFechas.fecha_factura)"
                                        ng-update-hidden type="text" data-date-format="dd/mm/yyyy" class="form-control date-picker"
                                        id="fecha-factura" ng-model="proformaFechas.fecha_factura" name="fecha-factura">
                                </div>

                            </div>

                            <div class=" form-group">
                                <div class="col-md-4">
                                    <label for="">Cobro</label>
                                </div>
                                <div class="col-md-8">
                                    <input autocomplete="off" disabled ng-update-hidden type="text" data-date-format="dd/mm/yyyy" class="form-control date-picker"
                                        id="fecha-cobro" ng-model="proformaFechas.fecha_cobro" name="fecha-cobro">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="modal-footer wizard-actions">
                        <button type="submit" id="siguiente-wizard-fechas-proforma" class="btn btn-success btn-sm btn-next" data-last="Finish">
                            Siguiente
                            <i class="ace-icon fa fa-arrow-right icon-on-right"></i>
                        </button>
                        <button type="button" class="btn btn-danger btn-sm pull-left" data-dismiss="modal" ng-click="cerrardialogmodalFechas()">
                            <i class="ace-icon fa fa-times"></i>
                            Cancelar
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<div class="modal" id="dialog-dosificaciones-disponibles" style="overflow-y:hidden;">
    <div class="modal-header bg-primary">
        <button type="button" ng-click="cerrardialogDosificacionesDisponibles()" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" id="advertenciaPrestamoPersonal">DOSIFICACIONES DISPONIBLES</h4>
    </div>
    <div class="modal-body">
        <div class="table-fixed-header" style="position: sticky !important;">
            <table class="table table-striped table-bordered table-hover ">
                <thead fix-head class="table-head-color">
                    <tr>
                        <th>
                            N°
                        </th>
                        <th>
                            autorizacion
                        </th>
                        <th>
                            Correlativo
                        </th>
                        <th>
                            Acciones
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="dosificacion in dosificaciones">
                        <td>
                            {{$index+1}}
                        </td>
                        <td>
                            {{dosificacion.autorizacion}}
                            <span ng-if="dosificacion.expirado" style="color: red">EXPIRADO</span>
                        </td>
                        <td>
                            {{dosificacion.correlativo}}
                        </td>
                        <td>
                            <a ng-click="abrirconfirmarDosificacion(dosificacion)">SELECCIONAR</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-danger" ng-click="cerrardialogDosificacionesDisponibles()" data-dismiss="modal">Cerrar</button>
    </div>
</div>

<div id="modalEmpresaCentroCosto" style="overflow-x:hidden !important" class="modal wizard-posicion">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="formEmpresaCentroCosto" name="form" novalidate ng-submit="guardarAsignacionCentroCostos(centroCostosClienteEmpresa.empresa)">
                <div class="row">
                    <h2 align="center" class="blue">Empresa</h2>
                </div>
                <div id="modal-wizard-panel-container">
                    <div class="modal-header steps-container">
                        <!-- <div class="modal-header"> -->
                        <ul class="steps">
                            <li data-step="1" class="active">
                                <span class="step">
                                    <span class="glyphicon glyphicon-cog"></span>
                                </span>
                                <span class="title">EMPRESA</span>
                            </li>
                            <li data-step="2">
                                <span class="step">
                                    <span class="fa fa-list-alt"></span>
                                </span>
                                <span class="title">Finalizar</span>
                            </li>
                        </ul>
                        <!-- </div> -->
                    </div>
                    <div class="modal-body step-content">
                        <div class="step-pane active" data-step="1">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="row form-group">
                                        <div class="col-lg-5">
                                            <label for="paterno">Empresa</label>
                                        </div>
                                        <div class="col-lg-7">
                                                <select style="max-width: 180px;width: 180px" ng-disabled="proforma.cliente" ng-change="obtenercentroCostosClienteEmpresa(centroCostosClienteEmpresa.empresa)"
                                                required id="ClienteEmpresa" ng-options="empresa as empresa.razon_social for empresa in clientes track by empresa.id"
                                                ng-model="centroCostosClienteEmpresa.empresa">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row form-group">
                                        <div class="col-lg-5">
                                            <label for="materno">Centro de costo</label>
                                        </div>
                                        <div class="col-lg-7">
                                                <select style="max-width: 180px;width: 180px" required id="centroCostoClienteEmpresa" ng-options="centroCosto as centroCosto.nombre for centroCosto in centroCostos track by centroCosto.id"
                                                ng-model="centroCostosClienteEmpresa.centroCosto">
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row form-group">
                                        <div class="container-fluid">
                                            <button type="button" class="btn btn-primary" ng-click="agregarDetalleCentroCostosCliente(centroCostosClienteEmpresa)">
                                                <i class="ace-icon fa fa-plus align-top bigger-125"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="row form-group">
                                        <div class="container-fluid">
                                            <table class="table table-striped table-bordered table-hover">
                                                <thead>
                                                    <th>Centro costos</th>
                                                    <th>Acciones</th>
                                                </thead>
                                                <tbody ng-if="!centroCosto.eliminado" ng-repeat="centroCosto in listaCentroCostosClienteEmpresa">
                                                    <td>
                                                        {{centroCosto.nombre}}
                                                    </td>
                                                    <td>
                                                        <a e-disabled="!aplicacion.puede_eliminar" class="red" ng-click="abrirPopupConfirmacionEliminacion(eliminarAsignacionCentroCosto,centroCosto)"
                                                            data-rel="tooltip" tooltip-placement="top" uib-tooltip="Eliminar">
                                                            <i class="ace-icon fa fa-trash-o bigger-130"></i>
                                                        </a>
                                                    </td>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="step-pane" data-step="2">
                            <div class="center">
                                <h4 class="blue">Finalización</h4>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="modal-footer wizard-actions">

                    <!-- <button class="btn btn-sm btn-prev">
                        <i class="ace-icon fa fa-arrow-left"></i>
                        Anterior
                    </button> -->

                    <button id="siguienteCCC" type="submit" ng-disabled="!aplicacion.puede_crear" class="btn btn-success btn-sm btn-next" data-last="Finish">
                        Siguiente
                        <i class="ace-icon fa fa-arrow-right icon-on-right"></i>
                    </button>

                    <button type="button" class="btn btn-danger btn-sm pull-left" data-dismiss="modal" ng-click="cerrarConfiguracionCentrosCostos()">
                        <i class="ace-icon fa fa-times"></i>
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>