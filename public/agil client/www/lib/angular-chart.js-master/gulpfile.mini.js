!function(){"use strict";var e=require("gulp-bump"),t=require("fs"),r=require("gulp-git"),s=require("gulp"),i=require("gulp-gzip"),p=require("gulp-header"),a=require("gulp-istanbul"),n=require("gulp-istanbul-report"),u=require("gulp-jshint"),o=require("gulp-jscs"),c=require("gulp-spawn-mocha"),l=require("gulp-mocha-phantomjs"),g=require("path"),m=require("./package.json"),h=require("gulp-rename"),k=require("gulp-rimraf"),d=require("gulp-sequence"),j=require("gulp-shell"),f=require("gulp-sourcemaps"),q=require("jshint-stylish"),v=require("gulp-tar"),b=require("gulp-uglify"),y=["/*!"," * <%= pkg.name %> - <%= pkg.description %>"," * <%= pkg.homepage %>"," * Version: <%= version %>"," *"," * Copyright 2016 Jerome Touffe-Blin"," * Released under the <%= pkg.license %> license"," * https://github.com/jtblin/angular-chart.js/blob/master/LICENSE"," */",""].join("\n");function w(t){return function(){return s.src(["./package.json","./bower.json"]).pipe(e({type:t})).pipe(s.dest("./"))}}function x(){return JSON.parse(t.readFileSync("package.json","utf8")).version}s.task("clean",function(){return s.src("./dist/*",{read:!1}).pipe(k())}),s.task("lint",function(){return s.src("**/*.js").pipe(u()).pipe(u.reporter(q))}),s.task("style",function(){return s.src("**/*.js").pipe(o())}),s.task("cover",function(){return s.src("angular-chart.js").pipe(a({coverageVariable:"__coverage__"})).pipe(h("coverage.js")).pipe(s.dest("test/fixtures"))}),s.task("unit",function(){return s.src("test/index.html",{read:!1}).pipe(l({phantomjs:{hooks:"mocha-phantomjs-istanbul",coverageFile:"coverage/coverage.json"},reporter:process.env.REPORTER||"spec"}))}),s.task("integration",function(){return s.src(g.join("test","test.integration.js"),{read:!1}).pipe(c({reporter:"list",timeout:2e4,require:"test/support/setup.js"}))}),s.task("report",function(){return s.src("coverage/coverage.json").pipe(n({reporters:["lcov"]}))}),s.task("bump-patch",w("patch")),s.task("bump-minor",w("minor")),s.task("bump-major",w("major")),s.task("bower",function(){return s.src("./angular-chart.js").pipe(p(y,{pkg:m,version:x()})).pipe(s.dest("./dist"))}),s.task("js",["lint","style","bower"],function(){return s.src("./angular-chart.js").pipe(p(y,{pkg:m,version:x()})).pipe(h("angular-chart.min.js")).pipe(f.init()).pipe(b({preserveComments:"license"})).pipe(f.write("./")).pipe(s.dest("./dist"))}),s.task("build",function(){return s.src(["dist/*","!./dist/*.tar.gz"]).pipe(v("angular-chart.js.tar")).pipe(i({gzipOptions:{level:9}})).pipe(s.dest("dist/"))}),s.task("update",function(e){t.readFile("./examples/charts.template.html","utf8",function(r,s){if(r)return e(r);s=s.replace("\x3c!-- version --\x3e",x()),t.writeFile("./examples/charts.html",s,e)})}),s.task("git-commit",function(){var e=x();s.src(["./dist/*","./package.json","./bower.json","./examples/charts.html","./test/fixtures/coverage.js"]).pipe(r.add()).pipe(r.commit(e))}),s.task("git-push",function(e){var t=x();r.push("origin","master",function(s){if(s)return e(s);r.tag(t,t,function(t){if(t)return e(t);r.push("origin","master",{args:"--tags"},e)})})}),s.task("npm",j.task(["npm publish"])),s.task("watch",function(){return s.watch("./*.js",["js"]),!0}),s.task("docker-test",j.task(["npm run docker-test"])),s.task("default",d("docker-test","assets")),s.task("assets",d("clean","js","build")),s.task("test",d("cover","unit","integration","report")),s.task("check",d(["lint","style"],"test")),s.task("deploy-patch",d("docker-test","bump-patch","assets","update","git-commit","git-push","npm")),s.task("deploy-minor",d("docker-test","bump-minor","assets","update","git-commit","git-push","npm")),s.task("deploy-major",d("docker-test","bump-patch","assets","update","git-commit","git-push","npm"))}();