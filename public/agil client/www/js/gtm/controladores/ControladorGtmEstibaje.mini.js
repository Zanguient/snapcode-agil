angular.module("agil.controladores").controller("ControladorGtmEstibaje",["$scope","$localStorage","$location","$templateCache","$route","blockUI","Paginator","FieldViewer","GtmEstibaje","GtmEstibajes","GtmEstibajeItem",function(a,i,e,t,o,r,s,n,d,c,u){r.start(),a.usuario=JSON.parse(i.usuario),a.idModalWizardEstibajeEdicion="modal-wizard-estibaje-edicion",a.idModalContenedorWizard="modal-wizard-container-estibaje-edicion",a.idModalEliminarEstibaje="dialog-eliminar-estibaje",a.idModalWizardEstibajeVista="modal-wizard-estibaje-vista",a.usuario=JSON.parse(i.usuario),a.$on("$viewContentLoaded",function(){resaltarPesta√±a(e.path().substring(1)),ejecutarScriptEstibaje(a.idModalWizardEstibajeEdicion,a.idModalContenedorWizard,a.idModalEliminarEstibaje,a.idModalWizardEstibajeVista),a.buscarAplicacion(a.usuario.aplicacionesUsuario,e.path().substring(1))}),a.inicio=function(){a.obtenerEstibajes()},a.obtenerEstibajes=function(){c(a.usuario.id_empresa).then(function(i){a.estibajes=i})},a.crearNuevoEstibaje=function(i,e){a.estibaje=new d({id_empresa:a.usuario.id_empresa}),a.abrirPopup(a.idModalWizardEstibajeEdicion)},a.cerrarPopPupEdicion=function(){a.cerrarPopup(a.idModalWizardEstibajeEdicion)},a.cerrarPopPupVista=function(){a.cerrarPopup(a.idModalWizardEstibajeVista)},a.modificarEstibaje=function(i,e){a.estibaje=i,a.estibaje.verDatos=!!e,a.abrirPopup(a.idModalWizardEstibajeEdicion)},a.removerEstibaje=function(i){i.eliminado=!0,u.update({id_estibaje:i.id},i,function(i){a.obtenerEstibajes(),r.stop(),a.mostrarMensaje(i.mensaje)})},a.guardarEstadoEstibaje=function(i){u.update({id_estibaje:i.id},i,function(i){a.obtenerEstibajes(),r.stop(),a.mostrarMensaje(i.mensaje),a.recargarItemsTabla()})},a.guardarEstibaje=function(i){"Siguiente"!=$("#siguiente").text().trim()&&(r.start(),i.id?u.update({id_estibaje:i.id},i,function(i){a.obtenerEstibajes(),r.stop(),a.cerrarPopPupEdicion(),a.mostrarMensaje(i.mensaje),a.recargarItemsTabla()}):i.$save(function(i){a.obtenerEstibajes(),r.stop(),a.cerrarPopPupEdicion(),a.mostrarMensaje("Estibaje creado satisfactoriamente!"),a.recargarItemsTabla()},function(i){r.stop(),a.cerrarPopPupEdicion(),a.mostrarMensaje("Ocurrio un problema al momento de guardar!")}))},a.$on("$routeChangeStart",function(i,e){a.eliminarPopup(a.idModalWizardEstibajeEdicion)}),a.inicio()}]);