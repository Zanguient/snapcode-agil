angular.module("agil.controladores").controller("ControladorGtmEstibaje",["$scope","$localStorage","$location","$templateCache","$route","blockUI","Paginator","FieldViewer","GtmEstibaje","GtmEstibajes","GtmEstibajeItem",function(e,a,i,t,o,r,s,n,d,c,u){r.start(),e.usuario=JSON.parse(a.usuario),e.idModalWizardEstibajeEdicion="modal-wizard-estibaje-edicion",e.idModalContenedorWizard="modal-wizard-container-estibaje-edicion",e.idModalEliminarEstibaje="dialog-eliminar-estibaje",e.idModalWizardEstibajeVista="modal-wizard-estibaje-vista",e.usuario=JSON.parse(a.usuario),e.$on("$viewContentLoaded",function(){resaltarPesta√±a(i.path().substring(1)),ejecutarScriptEstibaje(e.idModalWizardEstibajeEdicion,e.idModalContenedorWizard,e.idModalEliminarEstibaje,e.idModalWizardEstibajeVista),e.buscarAplicacion(e.usuario.aplicacionesUsuario,i.path().substring(1))}),e.inicio=function(){e.obtenerEstibajes()},e.obtenerEstibajes=function(){c(e.usuario.id_empresa).then(function(a){e.estibajes=a})},e.crearNuevoEstibaje=function(a,i){e.estibaje=new d({id_empresa:e.usuario.id_empresa}),e.abrirPopup(e.idModalWizardEstibajeEdicion)},e.cerrarPopPupEdicion=function(){e.cerrarPopup(e.idModalWizardEstibajeEdicion)},e.cerrarPopPupVista=function(){e.cerrarPopup(e.idModalWizardEstibajeVista)},e.modificarEstibaje=function(a,i){e.estibaje=a,e.estibaje.verDatos=!!i,e.abrirPopup(e.idModalWizardEstibajeEdicion)},e.removerEstibaje=function(a){a.eliminado=!0,u.update({id_estibaje:a.id},a,function(a){e.obtenerEstibajes(),r.stop(),e.mostrarMensaje(a.mensaje)})},e.guardarEstadoEstibaje=function(a){u.update({id_estibaje:a.id},a,function(a){e.obtenerEstibajes(),r.stop(),e.mostrarMensaje(a.mensaje),e.recargarItemsTabla()})},e.guardarEstibaje=function(a){"Siguiente"!=$("#siguiente").text().trim()&&(r.start(),a.id?u.update({id_estibaje:a.id},a,function(a){e.obtenerEstibajes(),r.stop(),e.cerrarPopPupEdicion(),e.mostrarMensaje(a.mensaje),e.recargarItemsTabla()}):a.$save(function(a){e.obtenerEstibajes(),r.stop(),e.cerrarPopPupEdicion(),e.mostrarMensaje("Estibaje creado satisfactoriamente!"),e.recargarItemsTabla()},function(a){r.stop(),e.cerrarPopPupEdicion(),e.mostrarMensaje("Ocurrio un problema al momento de guardar!")}))},e.$on("$routeChangeStart",function(a,i){e.eliminarPopup(e.idModalWizardEstibajeEdicion)}),e.inicio()}]);