angular.module("agil.controladores").controller("ControladorConfiguracionesApp",["$scope","$localStorage","$location","$templateCache","$route","blockUI","ConfiguracionesApp","ConfiguracionGeneralAppDato","ClasesTipo","ConfiguracionAppVendedor","ConfiguracionAppEmpresa",function(o,i,n,a,r,e,c,t,d,u,s){e.start(),o.idModalWizardConfiguracionEdicion="modal-wizard-configuracion-edicion",o.idModalWizardConfiguracionGeneralEdicion="modal-wizard-configuracion-general-edicion",o.idModalContenedorConfiguracionEdicion="modal-wizard-container-configuracion-edicion",o.idModalContenedorConfiguracionGeneralEdicion="modal-wizard-container-configuracion-general-edicion",o.usuario=JSON.parse(i.usuario),o.obtenerTiposVenta=function(){e.start(),d("MEA").then(function(i){o.tiposVenta=i.clases,e.stop()})},o.obtenerCobros=function(){e.start(),d("COA").then(function(i){o.cobros=i.clases,e.stop()})},o.obtenerTiposPago=function(){e.start(),d("TPA").then(function(i){o.tiposPago=i.clases,e.stop()})},o.obtenerListadoProductos=function(){e.start(),d("LPA").then(function(i){o.listadoProductos=i.clases,e.stop()})},o.obtenerConfiguracionesApp=function(){e.start(),c(o.usuario.id_empresa).then(function(i){o.vendedores=i,e.stop()})},o.obtenerConfiguracionGeneralApp=function(){e.start(),t(o.usuario.id_empresa).then(function(i){o.configuracion_general=i,e.stop()})},o.$on("$routeChangeStart",function(i,n){o.eliminarPopup(o.idModalWizardConfiguracionEdicion),o.eliminarPopup(o.idModalWizardConfiguracionGeneralEdicion)}),o.inicio=function(){o.obtenerConfiguracionesApp(),o.obtenerConfiguracionGeneralApp(),o.obtenerTiposVenta(),o.obtenerCobros(),o.obtenerTiposPago(),o.obtenerListadoProductos(),setTimeout(function(){ejecutarScriptsTabla("tabla-configuraciones",8),ejecutarScriptsTabla("tabla-configuracion-general",8)},2e3)},o.$on("$viewContentLoaded",function(){resaltarPesta√±a(n.path().substring(1)),ejecutarScriptsConfiguracionApp(o.idModalWizardConfiguracionEdicion,o.idModalContenedorConfiguracionEdicion,o.idModalWizardConfiguracionGeneralEdicion,o.idModalContenedorConfiguracionGeneralEdicion),o.buscarAplicacion(o.usuario.aplicacionesUsuario,n.path().substring(1)),e.stop()}),o.cerrarPopPupEdicion=function(){o.cerrarPopup(o.idModalWizardConfiguracionEdicion)},o.cerrarPopPupEdicionGeneral=function(){o.cerrarPopup(o.idModalWizardConfiguracionGeneralEdicion)},o.modificarConfiguracionVendedor=function(i){o.vendedor=i,o.abrirPopup(o.idModalWizardConfiguracionEdicion)},o.modificarConfiguracionGeneralApp=function(i){o.abrirPopup(o.idModalWizardConfiguracionGeneralEdicion)},o.guardarConfiguracion=function(i){"Siguiente"!=$("#siguiente").text().trim()&&(e.start(),u.update({id_configuracion:i.configuracionVendedorApp.id},i.configuracionVendedorApp,function(i){e.stop(),o.cerrarPopPupEdicion(),o.mostrarMensaje(i.mensaje),o.recargarItemsTabla()}))},o.guardarConfiguracionGeneral=function(i){"Siguiente"!=$("#siguiente-g").text().trim()&&(e.start(),s.update({id_configuracion:i.id},i,function(i){e.stop(),o.cerrarPopPupEdicionGeneral(),o.mostrarMensaje(i.mensaje),o.recargarItemsTabla()}))},o.inicio()}]);