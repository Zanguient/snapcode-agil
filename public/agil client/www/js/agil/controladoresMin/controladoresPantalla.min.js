angular.module("agil.controladores").controller("ControladorPantallaCliente",["$scope","$localStorage","$location","$templateCache","$route","blockUI","$timeout","Clases","ProductosPanel","socket",function(r,a,o,e,i,n,t,s,c,l){n.start(),r.usuario=JSON.parse(a.usuario),r.idModalPantallaCliente="dialog-pantalla-cliente",r.idModalPregunta="dialog-pregunta-video",r.idImagenPromocion1="imagen-promocion1",aplicarVisorImagenArchivo(r.idImagenPromocion1),aplicarVisorImagenArchivo("imagen-promocion2"),aplicarVisorImagenArchivo("imagen-promocion3"),r.idModalImagenesPromociones="dialog-imagenes-promociones",r.cargarPromociones=function(){r.imagen1=localStorage.getItem("imagen1"),r.imagen2=localStorage.getItem("imagen2"),r.imagen3=localStorage.getItem("imagen3")},r.saveForm=function(a){a.imagen1&&localStorage.setItem("imagen1",a.imagen1),a.imagen2&&localStorage.setItem("imagen2",a.imagen2),a.imagen3&&localStorage.setItem("imagen3",a.imagen3),r.cerrarAbrirModalImagenesPromociones(),r.mostrarMensaje("Guardado Exitosamente!"),r.cargarPromociones()},r.cargarPromociones(),$("#myCarousel").carousel({interval:4e3}),$("[id^=carousel-selector-]").click(function(){var a=$(this).attr("id"),o=a.substr(a.length-1);o=parseInt(o),$("#myCarousel").carousel(o),$("[id^=carousel-selector-]").removeClass("selected"),$(this).addClass("selected")}),$("#myCarousel").on("slid",function(a){var o=$(".item.active").data("slide-number");o=parseInt(o),$("[id^=carousel-selector-]").removeClass("selected"),$("[id=carousel-selector-"+o+"]").addClass("selected")}),r.inicio=function(){r.configuracionSockets(),r.Math=Math},r.abrirPantallaCliente=function(){r.abrirPopup(r.idModalPregunta)},r.abrirAbrirModalImagenesPromociones=function(){r.abrirPopup(r.idModalImagenesPromociones)},r.cerrarAbrirModalImagenesPromociones=function(){r.cerrarPopup(r.idModalImagenesPromociones)},r.mostrarVideoPantalla=function(a){r.mostrarProductos=!0,a?r.mostrarVideo=!0:(r.mostrarVideo=!1,r.cargarProductos()),r.cerrarPopup(r.idModalPregunta),r.abrirPopup(r.idModalPantallaCliente)},r.configuracionSockets=function(){l.on("mostrarVenta",function(a){for(var o=0,e=!1;o<r.usuario.empresa.sucursales.length&&!e;)r.usuario.empresa.sucursales[o].id==a.sucursal.id&&(e=!0,r.venta=a,r.mostrarProductos=!1),o++}),l.on("mostrarProductos",function(a){for(var o=0,e=!1;o<r.usuario.empresa.sucursales.length&&!e;)r.usuario.empresa.sucursales[o].id==a.id&&(e=!0,r.mostrarProductos=!0),o++})},r.cargarProductos=function(){c(r.usuario.id_empresa,r.usuario.sucursalesUsuario[0].sucursal.almacenes[0].id).then(function(a){for(var o=0;o<a.length;o++)a[o].inventario_disponible=r.obtenerInventarioTotal(a[o]);r.productos=a,r.productosProcesados=a,setTimeout(function(){aplicarSwiper(6,4,!0,2),$("#productos h3").css({color:"white"}),$("#productos label").css({color:"#3596EA"})},500)})},r.obtenerInventarioTotal=function(a){for(var o=0,e=0;e<a.inventarios.length;e++)o+=a.inventarios[e].cantidad;return o},r.$on("$viewContentLoaded",function(){resaltarPestaña(o.path().substring(1)),ejecutarScriptsPantallaCliente(r.idModalPantallaCliente,r.idModalPregunta,r.idModalImagenesPromociones),r.buscarAplicacion(r.usuario.aplicacionesUsuario,o.path().substring(1)),n.stop()}),r.$on("$routeChangeStart",function(a,o){r.eliminarPopup(r.idModalPantallaCliente),r.eliminarPopup(r.idModalPregunta)}),r.inicio()}]).controller("ControladorPantallaDespacho",["$scope","$localStorage","$location","$templateCache","$route","blockUI","$timeout","Clases","VentasNoDespachadasLista","DespachoVenta",function(e,a,o,r,i,n,t,s,c,l){n.start(),e.usuario=JSON.parse(a.usuario),e.idModalPantallaDespacho="dialog-pantalla-despacho",e.inicio=function(){},e.abrirPantallaDespacho=function(){e.abrirPopup(e.idModalPantallaDespacho),e.cargarPedidos()},e.cargarPedidos=function(){c(e.usuario.empresa.sucursales[0].id).then(function(a){e.ventas=a,setTimeout(function(){aplicarSwiper(6,4,!0,2),$("#productos .swiper-slide").addClass("btn-warning"),$("#productos h3").css({color:"white"}),$("#productos label").css({color:"#3596EA"})},500)})},e.emitirSonido=function(a){new Audio("sound/"+a.pedido+".wav").play()},e.despacharVenta=function(a){l.update({id_venta:a.id},a,function(a){e.cargarPedidos(),e.mostrarMensaje(a.mensaje)})},e.$on("$viewContentLoaded",function(){resaltarPestaña(o.path().substring(1)),ejecutarScriptsPantallaDespacho(e.idModalPantallaDespacho),e.buscarAplicacion(e.usuario.aplicacionesUsuario,o.path().substring(1)),n.stop()}),e.$on("$routeChangeStart",function(a,o){e.eliminarPopup(e.idModalPantallaDespacho)}),e.inicio()}]);