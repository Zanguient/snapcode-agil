angular.module("agil.controladores").controller("ControladorConfiguracionesApp",["$scope","$localStorage","$location","$templateCache","$route","blockUI","ConfiguracionesApp","ConfiguracionGeneralAppDato","ClasesTipo","ConfiguracionAppVendedor","ConfiguracionAppEmpresa",function(n,o,i,a,r,e,c,t,d,u,s){e.start(),n.idModalWizardConfiguracionEdicion="modal-wizard-configuracion-edicion",n.idModalWizardConfiguracionGeneralEdicion="modal-wizard-configuracion-general-edicion",n.idModalContenedorConfiguracionEdicion="modal-wizard-container-configuracion-edicion",n.idModalContenedorConfiguracionGeneralEdicion="modal-wizard-container-configuracion-general-edicion",n.usuario=JSON.parse(o.usuario),n.obtenerTiposVenta=function(){e.start(),d("MEA").then(function(o){n.tiposVenta=o.clases,e.stop()})},n.obtenerCobros=function(){e.start(),d("COA").then(function(o){n.cobros=o.clases,e.stop()})},n.obtenerTiposPago=function(){e.start(),d("TPA").then(function(o){n.tiposPago=o.clases,e.stop()})},n.obtenerListadoProductos=function(){e.start(),d("LPA").then(function(o){n.listadoProductos=o.clases,e.stop()})},n.obtenerConfiguracionesApp=function(){e.start(),c(n.usuario.id_empresa).then(function(o){n.vendedores=o,e.stop()})},n.obtenerConfiguracionGeneralApp=function(){e.start(),t(n.usuario.id_empresa).then(function(o){n.configuracion_general=o,e.stop()})},n.$on("$routeChangeStart",function(o,i){n.eliminarPopup(n.idModalWizardConfiguracionEdicion),n.eliminarPopup(n.idModalWizardConfiguracionGeneralEdicion)}),n.inicio=function(){n.obtenerConfiguracionesApp(),n.obtenerConfiguracionGeneralApp(),n.obtenerTiposVenta(),n.obtenerCobros(),n.obtenerTiposPago(),n.obtenerListadoProductos(),setTimeout(function(){ejecutarScriptsTabla("tabla-configuraciones",8),ejecutarScriptsTabla("tabla-configuracion-general",8)},2e3)},n.$on("$viewContentLoaded",function(){resaltarPesta√±a(i.path().substring(1)),ejecutarScriptsConfiguracionApp(n.idModalWizardConfiguracionEdicion,n.idModalContenedorConfiguracionEdicion,n.idModalWizardConfiguracionGeneralEdicion,n.idModalContenedorConfiguracionGeneralEdicion),n.buscarAplicacion(n.usuario.aplicacionesUsuario,i.path().substring(1)),e.stop()}),n.cerrarPopPupEdicion=function(){n.cerrarPopup(n.idModalWizardConfiguracionEdicion)},n.cerrarPopPupEdicionGeneral=function(){n.cerrarPopup(n.idModalWizardConfiguracionGeneralEdicion)},n.modificarConfiguracionVendedor=function(o){n.vendedor=o,n.abrirPopup(n.idModalWizardConfiguracionEdicion)},n.modificarConfiguracionGeneralApp=function(o){n.abrirPopup(n.idModalWizardConfiguracionGeneralEdicion)},n.guardarConfiguracion=function(o){"Siguiente"!=$("#siguiente").text().trim()&&(e.start(),u.update({id_configuracion:o.configuracionVendedorApp.id},o.configuracionVendedorApp,function(o){e.stop(),n.cerrarPopPupEdicion(),n.mostrarMensaje(o.mensaje),n.recargarItemsTabla()}))},n.guardarConfiguracionGeneral=function(o){"Siguiente"!=$("#siguiente-g").text().trim()&&(e.start(),s.update({id_configuracion:o.id},o,function(o){e.stop(),n.cerrarPopPupEdicionGeneral(),n.mostrarMensaje(o.mensaje),n.recargarItemsTabla()}))},n.inicio()}]);