angular.module("agil.controladores").controller("ControladorBancos",["$scope","$localStorage","$location","$templateCache","$route","blockUI","ClasesTipo","Clases","Banco","ListaBancos","BancoDatos","BancoPaginador","$window",function(i,a,o,n,r,c,e,t,d,s,u,l,p){c.start(),i.idModalWizardBancoEdicion="modal-wizard-banco",i.idModalWizardBancoVista="modal-wizard-banco-vista",i.idModalEliminarBanco="dialog-eliminar-banco",i.idModalContenedorBancoEdicion="modal-wizard-container-banco-edicion",i.idModalContenedorBancoVista="modal-wizard-container-banco-vista",i.usuario=JSON.parse(a.usuario),i.inicio=function(){i.paginadorBancos(i.usuario.id_empresa)},i.$on("$viewContentLoaded",function(){resaltarPesta√±a(o.path().substring(1)),ejecutarScriptsBanco(i.idModalWizardBancoEdicion,i.idModalContenedorBancoEdicion,i.idModalWizardBancoVista,i.idModalContenedorBancoVista,i.idModalEliminarBanco),i.buscarAplicacion(i.usuario.aplicacionesUsuario,o.path().substring(1));var a=e("TCB");a.then(function(a){i.tiposCuenta=a.clases,c.stop()}),(a=e("TM")).then(function(a){i.tiposMoneda=a.clases,c.stop()})}),i.crearNuevoBanco=function(){i.esNuevo=!0,i.banco=new d({id_empresa:i.usuario.id_empresa}),i.abrirPopup(i.idModalWizardBancoEdicion)},i.cerrarPopPupNuevoBanco=function(){i.cerrarPopup(i.idModalWizardBancoEdicion)},i.verBanco=function(a){i.banco=a,i.abrirPopup(i.idModalWizardBancoVista)},i.cerrarPopPupVista=function(){i.cerrarPopup(i.idModalWizardBancoVista)},i.cerrarPopPupEdicion=function(){i.cerrarPopup(i.idModalWizardBancoEdicion)},i.modificarBanco=function(a){i.banco=a,i.abrirPopup(i.idModalWizardBancoEdicion)},i.mostrarConfirmacionEliminacion=function(a){i.banco=new d(a),i.abrirPopup(i.idModalEliminarBanco)},i.cerrarConfirmacionEliminacion=function(){i.cerrarPopup(i.idModalEliminarBanco)},i.eliminarBanco=function(a){c.start(),i.cerrarConfirmacionEliminacion(),a.$delete(),i.mostrarMensaje("Eliminado exitosamente!"),i.recargarItemsTabla(),c.stop()},i.saveForm=function(a){var o=$("#siguiente").text().trim();console.log(o),"Siguiente"!=o&&(c.start(),a.id?u.update({id_banco:a.id},a,function(a){i.cerrarPopPupNuevoBanco(),i.mostrarMensaje("Actualizado Exitosamente!"),i.recargarItemsTabla()}):a.$save(function(a){c.stop(),i.banco=new d,i.cerrarPopPupNuevoBanco(),i.mostrarMensaje("Guardado Exitosamente!"),i.recargarItemsTabla()},function(a){c.stop(),i.cerrarPopPupNuevoBanco(),i.mostrarMensaje("Ocurrio un problema al momento de guardar!"),i.recargarItemsTabla()}))},i.obtenerBancos=function(a){c.start(),s(a).then(function(a){i.bancos=a,c.stop()})},i.$on("$routeChangeStart",function(a,o){i.eliminarPopup(i.idModalWizardBancoEdicion),i.eliminarPopup(i.idModalWizardBancoVista),i.eliminarPopup(i.idModalEliminarBanco)}),i.paginadorBancos=function(){i.abs=p.Math.abs,i.itemsPorPagina=10,i.buscarBancos(1,i.itemsPorPagina,"")},i.verificarPulso=function(a,o){13===a.keyCode&&i.buscarBancos(1,i.itemsPorPagina,o)},i.buscarBanco=function(a){if(""!=a&&null!=a)return l(i.usuario.id_empresa,a)},i.buscarBancos=function(a,o,n){c.start(),i.itemsPorPagina=o,""==n||null==n?n=0:i.textoBusqueda=n,i.paginaActual=a,l(i.usuario.id_empresa,a,o,n).then(function(a){i.paginas=[];for(var o=1;o<=a.paginas;o++)i.paginas.push(o);i.bancos=a.bancos,c.stop()})},i.inicio()}]);