angular.module("agil.controladores").controller("ControladorComprobanteDiario",function(O,e,o,n,a,_,r,t,i,c,u,s){O.usuario=JSON.parse(e.usuario),O.inicio=function(){O.obtenerTiposPeriodos(),O.obtenerGestiones(),O.obtenerTiposCuenta(),O.obtenerConfiguracionImpresion(),O.obtenerGestionesImpresion(),O.bimonetario=!1},O.$on("$viewContentLoaded",function(){resaltarPesta√±a(o.path().substring(1)),O.buscarAplicacion(O.usuario.aplicacionesUsuario,o.path().substring(1)),_.stop()}),O.obtenerTiposPeriodos=function(){_.start(),t("EEFF_TP").then(function(e){O.TiposPeriodos=e,_.stop()})},O.obtenerGestiones=function(){_.start(),t("GTN").then(function(e){O.gestiones=e.clases,_.stop()})},O.obtenerConfiguracionImpresion=function(){i(O.usuario.id_empresa).then(function(e){O.configuracionImpresion=e,O.configuracionImpresion.bimonetario=!0,O.configuracionImpresion.tioPeriodo="",O.configuracionImpresion.gestion="",O.configuracionImpresion.gestion_fin="",O.configuracionImpresion.mes="",O.configuracionImpresion.fecha_inicio=null,O.configuracionImpresion.fecha_fin=null,_.stop()})},O.cargarFechasFiltro=function(e){"FECHAS"==e&&setTimeout(function(){aplicarDatePickers()},300)},O.obtenerTiposCuenta=function(){_.start(),t("TCC").then(function(e){O.cuentaTipos=[{id:0,nombre:"PREESTABLECIDO"}],O.cuentaTipos=O.cuentaTipos.concat(e.clases),_.stop()})},O.obtenerGestionesImpresion=function(){_.start(),O.gestionesEF=[],u(O.usuario.id_empresa).then(function(e){_.stop(),e.forEach(function(e){e.habilitado&&(O.fechasImpresion=e)})})},O.generarPdfBalanceGeneral=function(){_.start(),O.configuracionImpresion.fecha_inicio&&(O.configuracionImpresion.inicio2=new Date(O.convertirFecha(O.configuracionImpresion.fecha_inicio)),O.configuracionImpresion.fin2=new Date(O.convertirFecha(O.configuracionImpresion.fecha_fin))),O.configuracionImpresion.fechasImpresion=O.fechasImpresion,c(O.configuracionImpresion,O.usuario.id_empresa).then(function(r){r.monedaCambio?O.moneda=r.monedaCambio:O.moneda={ufv:"--",dolar:"--"},r.arregloActivos=[],r.arregloActivosFijos=[],r.arregloPasivos=[],r.arregloPatrimonio=[],r.arregloIngreso=[],r.arregloEgreso=[],r.arregleCostos=[];if("COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){r.arregloPasivos=r.arregloPasivos.concat(r.arregloPatrimonio);var e=O.configuracionImpresion.bimonetario?400:530;"PREESTABLECIDO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarPdfPreestablecido(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion):"GENERICA"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarPdfPreestablecido(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion):"GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarPdfGrupo(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion):"SUB GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarPdfsubGrupo(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion):"APROPIACION"==O.configuracionImpresion.tipo_cuenta.nombre&&O.generarPdfApropiacion(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion)}else{var t=[],i=[],c=[],u=[],s=[],m=[],l=[];r.primero.cuentasGrupo.forEach(function(e,o,n){var a={};a.primerAno=e,t.push(a),o===n.length-1&&r.segundo.cuentasGrupo.forEach(function(e,o,n){for(var a=0;a<t.length;a++){var r=t[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasSubGrupo.forEach(function(e,o,n){var a={};a.primerAno=e,i.push(a),o===n.length-1&&r.segundo.cuentasSubGrupo.forEach(function(e,o,n){for(var a=0;a<i.length;a++){var r=i[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasGenericas.forEach(function(e,o,n){var a={};a.primerAno=e,c.push(a),o===n.length-1&&r.segundo.cuentasGenericas.forEach(function(e,o,n){for(var a=0;a<c.length;a++){var r=c[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasApropiacion.forEach(function(e,o,n){var a={};a.primerAno=e,u.push(a),o===n.length-1&&r.segundo.cuentasApropiacion.forEach(function(e,o,n){for(var a=0;a<u.length;a++){var r=u[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasSubGrupoFijo.forEach(function(e,o,n){var a={};a.primerAno=e,s.push(a),o===n.length-1&&r.segundo.cuentasSubGrupoFijo.forEach(function(e,o,n){for(var a=0;a<s.length;a++){var r=s[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasGenericasFijo.forEach(function(e,o,n){var a={};a.primerAno=e,m.push(a),o===n.length-1&&r.segundo.cuentasGenericasFijo.forEach(function(e,o,n){for(var a=0;a<m.length;a++){var r=m[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasApropiacionFijo.forEach(function(e,o,n){var a={};a.primerAno=e,l.push(a),o===n.length-1&&r.segundo.cuentasApropiacionFijo.forEach(function(e,o,n){for(var a=0;a<l.length;a++){var r=l[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})});e=O.configuracionImpresion.bimonetario?290:310;"PREESTABLECIDO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarPdfComprobantePreestablecido(r,e,t,i,c,u,s,m,l):"GENERICA"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarPdfComprobantePreestablecido(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l):"GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarPdfComparativoGrupo(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l):"SUB GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarPdfComparativosubGrupo(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l):"APROPIACION"==O.configuracionImpresion.tipo_cuenta.nombre&&O.generarPdfComparativoApropiacion(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l),_.stop()}})},O.generarExelBalanceGeneral=function(){_.start(),O.configuracionImpresion.fecha_inicio&&(O.configuracionImpresion.inicio2=new Date(O.convertirFecha(O.configuracionImpresion.fecha_inicio)),O.configuracionImpresion.fin2=new Date(O.convertirFecha(O.configuracionImpresion.fecha_fin))),O.configuracionImpresion.fechasImpresion=O.fechasImpresion,c(O.configuracionImpresion,O.usuario.id_empresa).then(function(r){r.monedaCambio?O.moneda=r.monedaCambio:O.moneda={ufv:"--",dolar:"--"},r.arregloActivos=[],r.arregloActivosFijos=[],r.arregloPasivos=[],r.arregloPatrimonio=[],r.arregloIngreso=[],r.arregloEgreso=[],r.arregleCostos=[];if("COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){r.arregloPasivos=r.arregloPasivos.concat(r.arregloPatrimonio);var e=O.configuracionImpresion.bimonetario?400:530;"PREESTABLECIDO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarExelAPreestablecido(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion):"GENERICA"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarExelAPreestablecido(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion):"GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarExelGrupo(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion):"SUB GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarExelSubGrupo(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion):"APROPIACION"==O.configuracionImpresion.tipo_cuenta.nombre&&O.generarExelApropiacion(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion)}else{var t=[],i=[],c=[],u=[],s=[],m=[],l=[];r.primero.cuentasGrupo.forEach(function(e,o,n){var a={};a.primerAno=e,t.push(a),o===n.length-1&&r.segundo.cuentasGrupo.forEach(function(e,o,n){for(var a=0;a<t.length;a++){var r=t[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasSubGrupo.forEach(function(e,o,n){var a={};a.primerAno=e,i.push(a),o===n.length-1&&r.segundo.cuentasSubGrupo.forEach(function(e,o,n){for(var a=0;a<i.length;a++){var r=i[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasGenericas.forEach(function(e,o,n){var a={};a.primerAno=e,c.push(a),o===n.length-1&&r.segundo.cuentasGenericas.forEach(function(e,o,n){for(var a=0;a<c.length;a++){var r=c[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasApropiacion.forEach(function(e,o,n){var a={};a.primerAno=e,u.push(a),o===n.length-1&&r.segundo.cuentasApropiacion.forEach(function(e,o,n){for(var a=0;a<u.length;a++){var r=u[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasSubGrupoFijo.forEach(function(e,o,n){var a={};a.primerAno=e,s.push(a),o===n.length-1&&r.segundo.cuentasSubGrupoFijo.forEach(function(e,o,n){for(var a=0;a<s.length;a++){var r=s[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasGenericasFijo.forEach(function(e,o,n){var a={};a.primerAno=e,m.push(a),o===n.length-1&&r.segundo.cuentasGenericasFijo.forEach(function(e,o,n){for(var a=0;a<m.length;a++){var r=m[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasApropiacionFijo.forEach(function(e,o,n){var a={};a.primerAno=e,l.push(a),o===n.length-1&&r.segundo.cuentasApropiacionFijo.forEach(function(e,o,n){for(var a=0;a<l.length;a++){var r=l[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})});e=O.configuracionImpresion.bimonetario?290:310;"PREESTABLECIDO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarExelComprobantePreestablecido(r,e,t,i,c,u,s,m,l):"GENERICA"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarExelComprobantePreestablecido(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l):"GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarExelComparativoGrupo(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l):"SUB GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarExelComparativosubGrupo(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l):"APROPIACION"==O.configuracionImpresion.tipo_cuenta.nombre&&O.generarExelComparativoApropiacion(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l),_.stop()}})},O.generarWordBalanceGeneral=function(){_.start(),O.configuracionImpresion.fecha_inicio&&(O.configuracionImpresion.inicio2=new Date(O.convertirFecha(O.configuracionImpresion.fecha_inicio)),O.configuracionImpresion.fin2=new Date(O.convertirFecha(O.configuracionImpresion.fecha_fin))),O.configuracionImpresion.fechasImpresion=O.fechasImpresion,c(O.configuracionImpresion,O.usuario.id_empresa).then(function(r){if(r.monedaCambio?O.moneda=r.monedaCambio:O.moneda={ufv:"--",dolar:"--"},"COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){var e=O.configuracionImpresion.bimonetario?400:530;"PREESTABLECIDO"==O.configuracionImpresion.tipo_cuenta.nombre?O.descargarArchivo(O.generarWordPreestablecido(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion),"reporte-balance-general.doc"):"GENERICA"==O.configuracionImpresion.tipo_cuenta.nombre?O.descargarArchivo(O.generarWordPreestablecido(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion),"reporte-balance-general.doc"):"GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.descargarArchivo(O.generarWordGrupo(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion),"reporte-balance-general.doc"):"SUB GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.descargarArchivo(O.generarWordSubGrupo(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion),"reporte-balance-general.doc"):"APROPIACION"==O.configuracionImpresion.tipo_cuenta.nombre&&O.descargarArchivo(O.generarWordApropiacion(r,e,r.cuentasGrupo,r.cuentasSubGrupo,r.cuentasGenericas,r.cuentasApropiacion),"reporte-balance-general.doc")}else{var t=[],i=[],c=[],u=[],s=[],m=[],l=[];r.primero.cuentasGrupo.forEach(function(e,o,n){var a={};a.primerAno=e,t.push(a),o===n.length-1&&r.segundo.cuentasGrupo.forEach(function(e,o,n){for(var a=0;a<t.length;a++){var r=t[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasSubGrupo.forEach(function(e,o,n){var a={};a.primerAno=e,i.push(a),o===n.length-1&&r.segundo.cuentasSubGrupo.forEach(function(e,o,n){for(var a=0;a<i.length;a++){var r=i[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasGenericas.forEach(function(e,o,n){var a={};a.primerAno=e,c.push(a),o===n.length-1&&r.segundo.cuentasGenericas.forEach(function(e,o,n){for(var a=0;a<c.length;a++){var r=c[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasApropiacion.forEach(function(e,o,n){var a={};a.primerAno=e,u.push(a),o===n.length-1&&r.segundo.cuentasApropiacion.forEach(function(e,o,n){for(var a=0;a<u.length;a++){var r=u[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasSubGrupoFijo.forEach(function(e,o,n){var a={};a.primerAno=e,s.push(a),o===n.length-1&&r.segundo.cuentasSubGrupoFijo.forEach(function(e,o,n){for(var a=0;a<s.length;a++){var r=s[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasGenericasFijo.forEach(function(e,o,n){var a={};a.primerAno=e,m.push(a),o===n.length-1&&r.segundo.cuentasGenericasFijo.forEach(function(e,o,n){for(var a=0;a<m.length;a++){var r=m[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})}),r.primero.cuentasApropiacionFijo.forEach(function(e,o,n){var a={};a.primerAno=e,l.push(a),o===n.length-1&&r.segundo.cuentasApropiacionFijo.forEach(function(e,o,n){for(var a=0;a<l.length;a++){var r=l[a];r.primerAno.id==e.id&&(r.segundoAno=e)}})});e=O.configuracionImpresion.bimonetario?290:310;"PREESTABLECIDO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarWordComprobantePreestablecido(r,e,t,i,c,u,s,m,l):"GENERICA"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarWordComprobantePreestablecido(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l):"GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarWordComparativoGrupo(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l):"SUB GRUPO"==O.configuracionImpresion.tipo_cuenta.nombre?O.generarWordComparativosubGrupo(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l):"APROPIACION"==O.configuracionImpresion.tipo_cuenta.nombre&&O.generarWordComparativoApropiacion(r,e,t,i,c,cuentasApropiacioncuentasSubGrupoFijo,m,l),_.stop()}})},O.generarPdfApropiacion=function(e,o,n,a,r,t){var i=new PDFDocument({size:"letter",margin:10}),c=i.pipe(blobStream()),u=a.length+r.length+t.length,s=130,m=0,l=O.configuracionImpresion.usar_empesar_numeracion?O.configuracionImpresion.empesar_numeracion:1,f=O.configuracionImpresion.usar_empesar_numeracion?O.configuracionImpresion.empesar_numeracion-1+Math.ceil(u/28):Math.ceil(u/28),p=0;O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8);for(var g=0;g<a.length&&m<=28;g++)if(cuenta=a[g],cuenta.total=0,"Activo"===cuenta.clasificacion.nombre){28==m&&(i.addPage({margin:0,bufferPages:!0}),s=140,m=0,l+=1,O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8)),i.text(cuenta.nombre,30,s),s+=20,m++;for(var d=0;d<r.length&&m<=28;d++){cuenta3=r[d];var b=String(cuenta3.codigo).substr(0,3);if(cuenta.codigo==b){if(t.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o})){i.text(cuenta3.nombre,40,s),s+=20,m++;for(var A=0;A<t.length&&m<=28;A++){cuenta2=t[A];b=String(cuenta2.codigo).substr(0,5);if(cuenta3.codigo==b){i.text(cuenta2.nombre,60,s),i.text(number_format(cuenta2.saldo,2),o,s);var v=cuenta2.saldo/O.moneda.dolar;O.configuracionImpresion.bimonetario&&i.text(number_format(v,2),o+130,s),cuenta.total+=cuenta2.saldo,p+=cuenta2.saldo,s+=20,28==++m&&(i.addPage({margin:0,bufferPages:!0}),s=140,m=0,l+=1,O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8))}else 28==m&&(i.addPage({margin:0,bufferPages:!0}),s=140,m=0,l+=1,O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8))}}}else 28==m&&(i.addPage({margin:0,bufferPages:!0}),s=140,m=0,l+=1,O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8))}i.text("TOTAL "+cuenta.nombre,90,s),i.text(number_format(cuenta.total,2),o,s);var I=cuenta.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&i.text(number_format(I,2),o+130,s),s+=20,m++,g===a.length-1&&O.DibujarFijoApropiacion(e,p,i,s,m,l,f,28,o)}else g===a.length-1&&O.DibujarFijoApropiacion(e,p,i,s,m,l,f,28,o);O.configuracionImpresion.usar_firma_uno&&(i.text(O.configuracionImpresion.firma_uno,170,720),i.text(O.configuracionImpresion.cargo_uno,170,730)),O.configuracionImpresion.usar_firma_dos&&(i.text(O.configuracionImpresion.firma_dos,370,720),i.text(O.configuracionImpresion.cargo_dos,370,730)),i.end(),c.on("finish",function(){var e=c.toBlobURL("application/pdf");window.open(e,"_blank","location=no")}),_.stop()},O.DibujarFijoApropiacion=function(e,o,n,a,r,t,i,c,u){if("COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){n.font("Helvetica",8);for(var s=0;s<e.cuentasSubGrupoFijo.length&&r<=c;s++)if(cuenta=e.cuentasSubGrupoFijo[s],cuenta.total=0,"Activo"===cuenta.clasificacion.nombre){r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8)),n.text(cuenta.nombre,30,a),a+=20,r++;for(var m=0;m<e.cuentasGenericasFijo.length&&r<=c;m++)if(cuenta3=e.cuentasGenericasFijo[m],"3"===cuenta3.tipoCuenta.nombre_corto){var l=String(cuenta3.codigo).substr(0,3);if(cuenta.codigo==l){if(e.cuentasApropiacionFijo.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o})){n.text(cuenta3.nombre,40,a),a+=20,r++;for(var f=0;f<e.cuentasApropiacionFijo.length&&r<=c;f++)if(cuenta2=e.cuentasApropiacionFijo[f],"4"===cuenta2.tipoCuenta.nombre_corto){l=String(cuenta2.codigo).substr(0,5);if(cuenta3.codigo==l){n.text(cuenta2.nombre,60,a),n.text(number_format(cuenta2.saldo,2),u-80,a);var p=cuenta2.saldo/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(p,2),u+65,a),a+=20,r++;for(var g=0;g<e.cuentasApropiacionFijo.length&&r<=c;g++)if(cuenta5=e.cuentasApropiacionFijo[g],"4"===cuenta5.tipoCuenta.nombre_corto){l=String(cuenta5.codigo).substr(4);if(String(cuenta2.codigo).substr(4)==l&&"Pasivo"===cuenta5.clasificacion.nombre){n.text(cuenta5.nombre,60,a),n.text("("+number_format(cuenta5.saldo,2)+")",u-80,a);var d=cuenta2.saldo-cuenta5.saldo;n.text(number_format(d,2),u,a);p=cuenta5.saldo/O.moneda.dolar;var b=d/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(p,2),u+65,a),O.configuracionImpresion.bimonetario&&n.text(number_format(b,2),u+130,a),cuenta.total+=d,o+=d,a+=20,++r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8));r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8));n.text("TOTAL "+cuenta.nombre,90,a),n.text(number_format(cuenta.total,2),u,a);var A=cuenta.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(A,2),u+130,a),a+=20,r++,s===e.cuentasSubGrupoFijo.length-1&&O.dibujarPatrimonio(e,o,n,a,r,t,i,c,u)}else s===e.cuentasSubGrupoFijo.length-1&&O.dibujarPatrimonio(e,o,n,a,r,t,i,c,u)}},O.DibujarFijoPreestablecido=function(e,o,n,a,r,t,i,c,u){n.font("Helvetica",8);for(var s=0;s<e.cuentasSubGrupoFijo.length&&r<=c;s++)if(cuenta=e.cuentasSubGrupoFijo[s],cuenta.total=0,"Activo"===cuenta.clasificacion.nombre){r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8)),n.text(cuenta.nombre,30,a),a+=20,r++;for(var m=0;m<e.cuentasGenericasFijo.length&&r<=c;m++)if(cuenta3=e.cuentasGenericasFijo[m],cuenta3.total=0,"3"===cuenta3.tipoCuenta.nombre_corto){var l=String(cuenta3.codigo).substr(0,3);if(cuenta.codigo==l){if(e.cuentasApropiacionFijo.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o})){n.text(cuenta3.nombre,40,a),a+=20,r++;for(var f=0;f<e.cuentasGenericasFijo.length&&r<=c;f++){cuenta6=e.cuentasGenericasFijo[f],cuenta6.total=0;l=String(cuenta6.codigo).substr(3);if(String(cuenta3.codigo).substr(3)==l&&"Pasivo"===cuenta6.clasificacion.nombre&&(n.text(cuenta6.nombre,40,a),a+=20,r++),f==e.cuentasGenericasFijo.length-1){for(var p=0;p<e.cuentasApropiacionFijo.length&&r<=c;p++)if(cuenta2=e.cuentasApropiacionFijo[p],"4"===cuenta2.tipoCuenta.nombre_corto){l=String(cuenta2.codigo).substr(0,5);if(cuenta3.codigo==l){cuenta3.total+=cuenta2.saldo;for(var g=cuenta2.saldo/O.moneda.dolar,d=0;d<e.cuentasApropiacionFijo.length&&r<=c;d++)if(cuenta5=e.cuentasApropiacionFijo[d],"4"===cuenta5.tipoCuenta.nombre_corto){l=String(cuenta5.codigo).substr(4);if(String(cuenta2.codigo).substr(4)==l&&"Pasivo"===cuenta5.clasificacion.nombre){cuenta6.total+=cuenta5.saldo;var b=cuenta2.saldo-cuenta5.saldo;g=cuenta5.saldo/O.moneda.dolar,O.moneda.dolar;cuenta.total+=b,o+=b,r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8));r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8));n.text(number_format(cuenta3.total,2),u-80,a-40);g=cuenta3.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(g,2),u+65,a-40),n.text("("+number_format(cuenta6.total,2)+")",u-80,a-20);g=cuenta6.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text("("+number_format(g,2)+")",u+65,a-20);var A=cuenta3.total-cuenta6.total,v=A/O.moneda.dolar;n.text(number_format(A,2),u,a-20),O.configuracionImpresion.bimonetario&&n.text(number_format(v,2),u+130,a-20)}}}}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8));n.text("TOTAL "+cuenta.nombre,90,a),n.text(number_format(cuenta.total,2),u,a);var I=cuenta.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(I,2),u+130,a),a+=20,r++,s===e.cuentasSubGrupoFijo.length-1&&O.dibujarPatrimonioPredefinido(e,o,n,a,r,t,i,c,u)}else s===e.cuentasSubGrupoFijo.length-1&&O.dibujarPatrimonioPredefinido(e,o,n,a,r,t,i,c,u)},O.DibujarFijoComparativoPreestablecido=function(e,o,n,a,r,t,i,c,u,s,m,l,f,p,g,d){n.font("Helvetica",8);for(var b=0;b<p.length&&r<=c;b++)if(cuenta=p[b],cuenta.primerAno.total=0,cuenta.segundoAno.total=0,"Activo"===cuenta.primerAno.clasificacion.nombre){r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8)),n.text(cuenta.primerAno.nombre,30,a),a+=20,r++;for(var A=0;A<g.length&&r<=c;A++){cuenta3=g[A],cuenta3.primerAno.total=0,cuenta3.segundoAno.total=0;var v=String(cuenta3.primerAno.codigo).substr(0,3);if(cuenta.primerAno.codigo==v){if(d.some(function(e){var o=String(e.primerAno.codigo).substr(0,5);return cuenta3.primerAno.codigo==o})){n.text(cuenta3.primerAno.nombre,40,a),a+=20,r++;for(var I=0;I<g.length&&r<=c;I++){cuenta6=g[I],cuenta6.primerAno.total=0,cuenta6.segundoAno.total=0;v=String(cuenta6.primerAno.codigo).substr(3);if(String(cuenta3.primerAno.codigo).substr(3)==v&&"Pasivo"===cuenta6.primerAno.clasificacion.nombre&&(n.text(cuenta6.primerAno.nombre,40,a),a+=20,r++),I==g.length-1){for(var P=0;P<d.length&&r<=c;P++)if(cuenta2=d[P],"4"===cuenta2.primerAno.tipoCuenta.nombre_corto){v=String(cuenta2.primerAno.codigo).substr(0,5);if(cuenta3.primerAno.codigo==v){cuenta3.primerAno.total+=cuenta2.primerAno.saldo,cuenta3.segundoAno.total+=cuenta2.segundoAno.saldo;for(var h=0;h<d.length&&r<=c;h++)if(cuenta5=d[h],"4"===cuenta5.primerAno.tipoCuenta.nombre_corto){v=String(cuenta5.primerAno.codigo).substr(4);if(String(cuenta2.primerAno.codigo).substr(4)==v&&"Pasivo"===cuenta5.primerAno.clasificacion.nombre){cuenta6.primerAno.total+=cuenta5.primerAno.saldo,cuenta6.segundoAno.total+=cuenta5.segundoAno.saldo;var _=cuenta2.primerAno.saldo-cuenta5.primerAno.saldo,G=cuenta2.segundoAno.saldo-cuenta5.segundoAno.saldo;cuenta.primerAno.total+=_,o.totalActivosPrimerAnio+=_,cuenta.segundoAno.total+=G,o.totalActivosSegundoAnio+=G,r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8));r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8));n.text(cuenta3.primerAno.total.toFixed(2),u-80,a-40),n.text(cuenta3.segundoAno.total.toFixed(2),u+130,a-40);cuenta3.primerAno.total,O.moneda.dolar;n.text("("+cuenta6.primerAno.total.toFixed(2)+")",u-80,a-20),n.text("("+cuenta6.segundoAno.total.toFixed(2)+")",u+130,a-20);cuenta6.primerAno.total,O.moneda.dolar;var C=(S=cuenta3.primerAno.total-cuenta6.primerAno.total)/O.moneda.dolar;n.text(number_format(S,2),u,a-20),O.configuracionImpresion.bimonetario&&n.text(number_format(C,2),u+80,a-20);var S;C=(S=cuenta3.segundoAno.total-cuenta6.segundoAno.total)/O.moneda.dolar;n.text(number_format(S,2),u+180,a-20),O.configuracionImpresion.bimonetario&&n.text(number_format(C,2),u+260,a-20)}}}}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}n.text("TOTAL "+cuenta.primerAno.nombre,90,a),n.text(number_format(cuenta.primerAno.total,2),u,a);var x=cuenta.primerAno.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(x,2),u+80,a),n.text(number_format(cuenta.segundoAno.total,2),u+180,a);x=cuenta.segundoAno.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(x,2),u+260,a),a+=20,r++,b===p.length-1&&O.dibujarPatrimonioComparativoPredefinido(e,o,n,a,r,t,i,c,u,s,m,l,f)}else b===p.length-1&&O.dibujarPatrimonioComparativoPredefinido(e,o,n,a,r,t,i,c,u,s,m,l,f)},O.DibujarFijoSubGrupo=function(e,o,n,a,r,t,i,c,u){if("COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){n.font("Helvetica",8);for(var s=0;s<e.cuentasSubGrupoFijo.length&&r<=c;s++)if(cuenta=e.cuentasSubGrupoFijo[s],cuenta.total=0,"Activo"===cuenta.clasificacion.nombre){r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8)),n.text(cuenta.nombre,30,a),a+=20,r++;for(var m=0;m<e.cuentasGenericasFijo.length&&r<=c;m++){cuenta3=e.cuentasGenericasFijo[m],cuenta3.total=0;var l=String(cuenta3.codigo).substr(0,3);if(cuenta.codigo==l){if(e.cuentasApropiacionFijo.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o}))for(var f=0;f<e.cuentasGenericasFijo.length&&r<=c;f++){cuenta6=e.cuentasGenericasFijo[f],cuenta6.total=0;l=String(cuenta6.codigo).substr(3),String(cuenta3.codigo).substr(3);if(f==e.cuentasGenericasFijo.length-1)for(var p=0;p<e.cuentasApropiacionFijo.length&&r<=c;p++){cuenta2=e.cuentasApropiacionFijo[p];l=String(cuenta2.codigo).substr(0,5);if(cuenta3.codigo==l){cuenta3.total+=cuenta2.saldo;for(var g=0;g<e.cuentasApropiacionFijo.length&&r<=c;g++){cuenta5=e.cuentasApropiacionFijo[g];l=String(cuenta5.codigo).substr(4);if(String(cuenta2.codigo).substr(4)==l&&"Pasivo"===cuenta5.clasificacion.nombre){cuenta6.total+=cuenta5.saldo;var d=cuenta2.saldo-cuenta5.saldo;cuenta.total+=d,o+=d}}}}}}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8))}n.text("TOTAL "+cuenta.nombre,90,a),n.text(number_format(cuenta.total,2),u,a);var b=cuenta.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(b,2),u+130,a),a+=20,r++,s===e.cuentasSubGrupoFijo.length-1&&O.dibujarPatrimonioSubGrupo(e,o,n,a,r,t,i,c,u)}else s===e.cuentasSubGrupoFijo.length-1&&O.dibujarPatrimonioSubGrupo(e,o,n,a,r,t,i,c,u)}},O.DibujarFijoGrupo=function(e,o,n,a,r,t,i,c,u){if("COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){n.font("Helvetica",8);for(var s=0;s<e.cuentasSubGrupoFijo.length&&r<=c;s++)if(cuenta=e.cuentasSubGrupoFijo[s],cuenta.total=0,"Activo"===cuenta.clasificacion.nombre){r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8));for(var m=0;m<e.cuentasGenericasFijo.length&&r<=c;m++){cuenta3=e.cuentasGenericasFijo[m],cuenta3.total=0;var l=String(cuenta3.codigo).substr(0,3);if(cuenta.codigo==l&&e.cuentasApropiacionFijo.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o}))for(var f=0;f<e.cuentasGenericasFijo.length&&r<=c;f++){cuenta6=e.cuentasGenericasFijo[f],cuenta6.total=0;l=String(cuenta6.codigo).substr(3);if(String(cuenta3.codigo).substr(3)==l&&cuenta6.clasificacion.nombre,f==e.cuentasGenericasFijo.length-1)for(var p=0;p<e.cuentasApropiacionFijo.length&&r<=c;p++){cuenta2=e.cuentasApropiacionFijo[p];l=String(cuenta2.codigo).substr(0,5);if(cuenta3.codigo==l){cuenta3.total+=cuenta2.saldo;cuenta2.saldo,O.moneda.dolar;for(var g=0;g<e.cuentasApropiacionFijo.length&&r<=c;g++){cuenta5=e.cuentasApropiacionFijo[g];l=String(cuenta5.codigo).substr(4);if(String(cuenta2.codigo).substr(4)==l&&"Pasivo"===cuenta5.clasificacion.nombre){cuenta6.total+=cuenta5.saldo;var d=cuenta2.saldo-cuenta5.saldo;cuenta.total+=d,o+=d}}}}}}n.text("TOTAL "+cuenta.nombre,90,a),n.text(number_format(cuenta.total,2),u,a);var b=cuenta.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(b,2),u+130,a),a+=20,r++,s===e.cuentasSubGrupoFijo.length-1&&O.dibujarPatrimonioGrupo(e,o,n,a,r,t,i,c,u)}else s===e.cuentasSubGrupoFijo.length-1&&O.dibujarPatrimonioGrupo(e,o,n,a,r,t,i,c,u)}},O.dibujarPatrimonio=function(e,o,n,a,r,t,i,c,u){if("COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){var s=0;n.font("Helvetica-Bold",8),n.text("TOTAL ACTIVOS  ",30,a),n.text(number_format(o,2),u,a);var m=o/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(m,2),u+130,a),a+=20,n.text("PASIVO Y PATRIMONIO",0,a,{align:"center"}),a+=20;for(var l=0;l<e.cuentasSubGrupo.length&&r<=c;l++){var f=e.cuentasSubGrupo[l];if("Pasivo"===f.clasificacion.nombre){r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8)),n.text(f.nombre,30,a),a+=20,r++;for(var p=f.total=0;p<e.cuentasGenericas.length&&r<=c;p++){var g=e.cuentasGenericas[p];if("3"===g.tipoCuenta.nombre_corto){var d=String(g.codigo).substr(0,3);if(f.codigo==d){if(e.cuentasApropiacion.some(function(e){var o=String(e.codigo).substr(0,5);return g.codigo==o})){n.text(g.nombre,40,a),a+=20,r++;for(var b=0;b<e.cuentasApropiacion.length&&r<=c;b++){var A=e.cuentasApropiacion[b];if("4"===A.tipoCuenta.nombre_corto){d=String(A.codigo).substr(0,5);if(g.codigo==d){n.text(A.nombre,60,a),n.text(number_format(A.saldo,2),u,a);var v=A.saldo/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(v,2),u+130,a),f.total+=A.saldo,s+=A.saldo,a+=20,++r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}}}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}n.text("TOTAL "+f.nombre,90,a),n.text(number_format(f.total,2),u,a);v=Math.round(f.total/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(v,2),u+130,a),a+=20,r++}if(l===e.cuentasSubGrupo.length-1){n.font("Helvetica-Bold",8),n.text("TOTAL PASIVO:  ",30,a),n.text(number_format(s,2),u,a);v=Math.round(s/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(v,2),u+130,a)}}}},O.dibujarPatrimonioComparativoPredefinido=function(e,o,n,a,r,t,i,c,u,s,m,l,f){var p={totalPasivoPrimerAnio:0,totalPasivoSegundoAnio:0};n.font("Helvetica-Bold",8),n.text("TOTAL ACTIVOS  ",30,a),n.text(number_format(o.totalActivosPrimerAnio,2),u,a);var g=o.totalActivosPrimerAnio/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(g,2),u+130,a),a+=20,r++,n.text("PASIVO Y PATRIMONIO",0,a,{align:"center"}),r++,a+=20;for(var d=0;d<m.length&&r<=c;d++){n.font("Helvetica",8);var b=m[d];if("Pasivo"===b.primerAno.clasificacion.nombre||"Capital"==b.primerAno.clasificacion.nombre){r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8)),n.text(b.primerAno.nombre,30,a),b.primerAno.total=0,a+=20,r++;for(var A=b.segundoAno.total=0;A<l.length&&r<=c;A++){var v=l[A],I=String(v.primerAno.codigo).substr(0,3);if(b.primerAno.codigo==I){if(f.some(function(e){var o=String(e.primerAno.codigo).substr(0,5);return v.primerAno.codigo==o})){n.text(v.primerAno.nombre,40,a),v.primerAno.total=0,v.primerAno.totalSus=0,v.segundoAno.total=0;for(var P=v.segundoAno.totalSus=0;P<f.length&&r<=c;P++){var h=f[P];if("4"===h.primerAno.tipoCuenta.nombre_corto){I=String(h.primerAno.codigo).substr(0,5);v.primerAno.codigo==I&&(v.primerAno.total+=h.primerAno.saldo,v.primerAno.totalSus+=h.primerAno.saldo/O.moneda.dolar,b.primerAno.total+=h.primerAno.saldo,v.segundoAno.total+=h.segundoAno.saldo,v.segundoAno.totalSus+=h.segundoAno.saldo/O.moneda.dolar,b.segundoAno.total+=h.segundoAno.saldo,p.totalPasivoPrimerAnio+=h.primerAno.saldo,p.totalPasivoSegundoAnio+=h.segundoAno.saldo),r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}n.text(v.primerAno.total,u,a),O.configuracionImpresion.bimonetario&&n.text(number_format(v.primerAno.totalSus,2),u+80,a),n.text(v.segundoAno.total,u+180,a),O.configuracionImpresion.bimonetario&&n.text(number_format(v.segundoAno.totalSus,2),u+260,a),a+=20,r++}}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}n.text("TOTAL "+b.primerAno.nombre,90,a),n.text(number_format(b.primerAno.total,2),u,a),n.text(number_format(b.segundoAno.total,2),u+180,a);var _=Math.round(b.primerAno.total/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(_,2),u+80,a);_=Math.round(b.segundoAno.total/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(_,2),u+260,a),a+=20,r++}if(d===m.length-1){n.font("Helvetica-Bold",8),n.text("TOTAL PASIVO:  ",30,a),n.text(number_format(p.totalPasivoPrimerAnio,2),u,a);_=Math.round(p.totalPasivoPrimerAnio/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(_,2),u+80,a),n.text(number_format(p.totalPasivoSegundoAnio,2),u+180,a);_=Math.round(p.totalPasivoSegundoAnio/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(_,2),u+260,a)}}},O.dibujarPatrimonioPredefinido=function(e,o,n,a,r,t,i,c,u){var s=0;n.font("Helvetica-Bold",8),n.text("TOTAL ACTIVOS  ",30,a),n.text(number_format(o,2),u,a);var m=o/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(m,2),u+130,a),a+=20,r++,n.text("PASIVO Y PATRIMONIO",0,a,{align:"center"}),a+=20,r++;for(var l=0;l<e.cuentasSubGrupo.length&&r<=c;l++){n.font("Helvetica",8);var f=e.cuentasSubGrupo[l];if("Pasivo"===f.clasificacion.nombre||"Capital"==f.clasificacion.nombre){r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8)),n.text(f.nombre,30,a),a+=20,r++;for(var p=f.total=0;p<e.cuentasGenericas.length&&r<=c;p++){var g=e.cuentasGenericas[p];if("3"===g.tipoCuenta.nombre_corto){var d=String(g.codigo).substr(0,3);if(f.codigo==d){if(e.cuentasApropiacion.some(function(e){var o=String(e.codigo).substr(0,5);return g.codigo==o})){n.text(g.nombre,40,a),g.total=0;for(var b=g.totalSus=0;b<e.cuentasApropiacion.length&&r<=c;b++){var A=e.cuentasApropiacion[b];if("4"===A.tipoCuenta.nombre_corto){d=String(A.codigo).substr(0,5);g.codigo==d&&(g.total+=A.saldo,g.totalSus+=A.saldo/O.moneda.dolar,f.total+=A.saldo,s+=A.saldo),r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}n.text(g.total,u,a),O.configuracionImpresion.bimonetario&&n.text(number_format(g.totalSus,2),u+130,a),a+=20,r++}}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}else r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8))}n.text("TOTAL "+f.nombre,90,a),n.text(number_format(f.total,2),u,a);var v=Math.round(f.total/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(v,2),u+130,a),a+=20,r++}if(l===e.cuentasSubGrupo.length-1){n.font("Helvetica-Bold",8),n.text("TOTAL PASIVO:  ",30,a),n.text(number_format(s,2),u,a);v=Math.round(s/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(v,2),u+130,a)}}},O.dibujarPatrimonioSubGrupo=function(e,o,n,a,r,t,i,c,u){if("COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){var s=0;n.font("Helvetica-Bold",8),n.text("TOTAL ACTIVOS  ",30,a),n.text(number_format(o,2),u,a);var m=o/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(m,2),u+130,a),a+=20,r++,n.text("PASIVO Y PATRIMONIO",0,a,{align:"center"}),a+=20,r++;for(var l=0;l<e.cuentasSubGrupo.length&&r<=c;l++){n.font("Helvetica",8);var f=e.cuentasSubGrupo[l];if("Pasivo"===f.clasificacion.nombre||"Capital"==f.clasificacion.nombre){r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"PASIVO Y PATRIMONIO"),n.font("Helvetica",8)),n.text(f.nombre,30,a),f.total=0;for(var p=f.totalSus=0;p<e.cuentasGenericas.length&&r<=c;p++){var g=e.cuentasGenericas[p];if("3"===g.tipoCuenta.nombre_corto){var d=String(g.codigo).substr(0,3);if(f.codigo==d&&e.cuentasApropiacion.some(function(e){var o=String(e.codigo).substr(0,5);return g.codigo==o}))for(var b=0;b<e.cuentasApropiacion.length&&r<=c;b++){var A=e.cuentasApropiacion[b];if("4"===A.tipoCuenta.nombre_corto){d=String(A.codigo).substr(0,5);g.codigo==d&&(f.totalSus+=A.saldo/O.moneda.dolar,f.total+=A.saldo,s+=A.saldo)}}}}n.text(f.total,u,a),O.configuracionImpresion.bimonetario&&n.text(number_format(f.totalSus,2),u+130,a),a+=20,r++,n.text("TOTAL "+f.nombre,90,a),n.text(number_format(f.total,2),u,a);var v=Math.round(f.total/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(v,2),u+130,a),a+=20,r++}if(l===e.cuentasSubGrupo.length-1){n.font("Helvetica-Bold",8),n.text("TOTAL PASIVO:  ",30,a),n.text(number_format(s,2),u,a);v=Math.round(s/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(v,2),u+130,a)}}}},O.dibujarPatrimonioGrupo=function(e,o,n,a,r,t,i,c,u){if("COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){var s=0;n.font("Helvetica-Bold",8),n.text("TOTAL ACTIVOS  ",30,a),n.text(number_format(o,2),u,a);var m=o/O.moneda.dolar;O.configuracionImpresion.bimonetario&&n.text(number_format(m,2),u+130,a),a+=20,r++,n.text("PASIVO Y PATRIMONIO",0,a,{align:"center"}),a+=20,r++;for(var l=0;l<e.cuentasGrupo.length&&r<=c;l++){if(cuenta=e.cuentasGrupo[l],cuenta.total=0,cuenta.totalSus=0,"Pasivo"===cuenta.clasificacion.nombre||"Capital"===cuenta.clasificacion.nombre){r==c&&(n.addPage({margin:0,bufferPages:!0}),a=140,r=0,t+=1,O.dibujarCabeceraPDFBalanceGeneral(n,t,i,"ACTIVO"),n.font("Helvetica",8)),n.text(cuenta.nombre,30,a);for(var f=0;f<e.cuentasSubGrupo.length&&r<=c;f++)if(cuenta4=e.cuentasSubGrupo[f],"2"===cuenta4.tipoCuenta.nombre_corto){var p=String(cuenta4.codigo).substr(0,1);if(cuenta.codigo==p)for(var g=0;g<e.cuentasGenericas.length&&r<=c;g++)if(cuenta3=e.cuentasGenericas[g],"3"===cuenta3.tipoCuenta.nombre_corto){p=String(cuenta3.codigo).substr(0,3);if(cuenta4.codigo==p&&e.cuentasApropiacion.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o}))for(var d=0;d<e.cuentasApropiacion.length&&r<=c;d++)if(cuenta2=e.cuentasApropiacion[d],"4"===cuenta2.tipoCuenta.nombre_corto){p=String(cuenta2.codigo).substr(0,5);cuenta3.codigo==p&&(cuenta.total+=cuenta2.saldo,cuenta.totalSus+=cuenta2.saldo,s+=cuenta2.saldo)}}}n.text(cuenta.total,u,a),O.configuracionImpresion.bimonetario&&n.text(number_format(cuenta.totalSus,2),u+130,a),a+=20,r++,n.text("TOTAL "+cuenta.nombre,90,a),n.text(number_format(cuenta.total,2),u,a);var b=Math.round(cuenta.total/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(b,2),u+130,a),a+=20,r++}if(l===e.cuentasGrupo.length-1){n.font("Helvetica-Bold",8),n.text("TOTAL PASIVO:  ",30,a),n.text(number_format(s,2),u,a);b=Math.round(s/O.moneda.dolar*1e4)/1e4;O.configuracionImpresion.bimonetario&&n.text(number_format(b,2),u+130,a)}}}},O.generarPdfPreComparativo=function(e,o,n,a,r,t,i,c,u){},O.generarPdfGrupo=function(e,o,n,a,r,t){if("COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){var i=new PDFDocument({size:"letter",margin:10}),c=i.pipe(blobStream()),u=[],s=[],m=130,l=0,f=O.configuracionImpresion.usar_empesar_numeracion?O.configuracionImpresion.empesar_numeracion:1,p=O.configuracionImpresion.usar_empesar_numeracion?O.configuracionImpresion.empesar_numeracion-1+Math.ceil((u.length+s.length)/28):Math.ceil((u.length+s.length)/28),g=0;O.dibujarCabeceraPDFBalanceGeneral(i,f,p,"ACTIVO"),i.font("Helvetica",8);for(var d=0;d<n.length&&l<=28;d++)if(cuenta=n[d],cuenta.total=0,cuenta.totalSus=0,"Activo"===cuenta.clasificacion.nombre){28==l&&(i.addPage({margin:0,bufferPages:!0}),m=140,l=0,f+=1,O.dibujarCabeceraPDFBalanceGeneral(i,f,p,"ACTIVO"),i.font("Helvetica",8)),i.text(cuenta.nombre,30,m);for(var b=0;b<a.length&&l<=28;b++)if(cuenta4=a[b],"2"===cuenta4.tipoCuenta.nombre_corto){var A=String(cuenta4.codigo).substr(0,1);if(cuenta.codigo==A)for(var v=0;v<r.length&&l<=28;v++)if(cuenta3=r[v],"3"===cuenta3.tipoCuenta.nombre_corto){A=String(cuenta3.codigo).substr(0,3);if(cuenta4.codigo==A&&t.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o}))for(var I=0;I<t.length&&l<=28;I++)if(cuenta2=t[I],"4"===cuenta2.tipoCuenta.nombre_corto){A=String(cuenta2.codigo).substr(0,5);cuenta3.codigo==A&&(cuenta.total+=cuenta2.saldo,cuenta.totalSus+=cuenta2.saldo,g+=cuenta2.saldo)}}}O.configuracionImpresion.bimonetario&&i.text(number_format(cuenta.totalSus,2),o+130,m),i.text(number_format(cuenta.total,2),o,m),m+=20,l++,i.text("TOTAL "+cuenta.nombre,90,m),i.text(number_format(cuenta.total,2),o,m);var P=cuenta.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&i.text(number_format(P,2),o+130,m),m+=20,l++,d===n.length-1&&O.DibujarFijoGrupo(e,g,i,m,l,f,p,28,o)}else d===n.length-1&&O.DibujarFijoGrupo(e,g,i,m,l,f,p,28,o);O.configuracionImpresion.usar_firma_uno&&(i.text(O.configuracionImpresion.firma_uno,170,720),i.text(O.configuracionImpresion.cargo_uno,170,730)),O.configuracionImpresion.usar_firma_dos&&(i.text(O.configuracionImpresion.firma_dos,370,720),i.text(O.configuracionImpresion.cargo_dos,370,730)),i.end(),c.on("finish",function(){var e=c.toBlobURL("application/pdf");window.open(e,"_blank","location=no")}),_.stop()}},O.generarPdfsubGrupo=function(e,o,n,a,r,t){if("COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre){var i=new PDFDocument({size:"letter",margin:10}),c=i.pipe(blobStream()),u=[],s=[],m=130,l=0,f=O.configuracionImpresion.usar_empesar_numeracion?O.configuracionImpresion.empesar_numeracion:1,p=O.configuracionImpresion.usar_empesar_numeracion?O.configuracionImpresion.empesar_numeracion-1+Math.ceil((u.length+s.length)/28):Math.ceil((u.length+s.length)/28),g=0;O.dibujarCabeceraPDFBalanceGeneral(i,f,p,"ACTIVO"),i.font("Helvetica",8);for(var d=0;d<a.length&&l<=28;d++)if(cuenta=a[d],cuenta.total=0,"Activo"===cuenta.clasificacion.nombre){28==l&&(i.addPage({margin:0,bufferPages:!0}),m=140,l=0,f+=1,O.dibujarCabeceraPDFBalanceGeneral(i,f,p,"ACTIVO"),i.font("Helvetica",8)),i.text(cuenta.nombre,30,m);for(var b=0;b<r.length&&l<=28;b++)if(cuenta3=r[b],"3"===cuenta3.tipoCuenta.nombre_corto){var A=String(cuenta3.codigo).substr(0,3);if(cuenta.codigo==A&&t.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o}))for(var v=0;v<t.length&&l<=28;v++)if(cuenta2=t[v],"4"===cuenta2.tipoCuenta.nombre_corto){A=String(cuenta2.codigo).substr(0,5);cuenta3.codigo==A&&(cuenta.total+=cuenta2.saldo,cuenta.totalSus+=cuenta2.saldo,g+=cuenta2.saldo)}}O.configuracionImpresion.bimonetario&&i.text(number_format(cuenta.totalSus,2),o+130,m),i.text(number_format(cuenta.total,2),o,m),m+=20,l++,i.text("TOTAL "+cuenta.nombre,90,m),i.text(number_format(cuenta.total,2),o,m);var I=cuenta.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&i.text(number_format(I,2),o+130,m),m+=20,l++,d===a.length-1&&O.DibujarFijoSubGrupo(e,g,i,m,l,f,p,28,o)}else d===a.length-1&&O.DibujarFijoSubGrupo(e,g,i,m,l,f,p,28,o);O.configuracionImpresion.usar_firma_uno&&(i.text(O.configuracionImpresion.firma_uno,170,720),i.text(O.configuracionImpresion.cargo_uno,170,730)),O.configuracionImpresion.usar_firma_dos&&(i.text(O.configuracionImpresion.firma_dos,370,720),i.text(O.configuracionImpresion.cargo_dos,370,730)),i.end(),c.on("finish",function(){var e=c.toBlobURL("application/pdf");window.open(e,"_blank","location=no")}),_.stop()}},O.generarPdfPreestablecido=function(e,o,n,a,r,t){var i=new PDFDocument({size:"letter",margin:10}),c=i.pipe(blobStream()),u=a.length+r.length,s=130,m=0,l=O.configuracionImpresion.usar_empesar_numeracion?O.configuracionImpresion.empesar_numeracion:1,f=O.configuracionImpresion.usar_empesar_numeracion?O.configuracionImpresion.empesar_numeracion-1+Math.ceil(u/28):Math.ceil(u/28),p=0;O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8);for(var g=0;g<a.length&&m<=28;g++)if(cuenta=a[g],cuenta.total=0,"Activo"===cuenta.clasificacion.nombre){28==m&&(i.addPage({margin:0,bufferPages:!0}),s=140,m=0,l+=1,O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8)),i.text(cuenta.nombre,30,s),s+=20,m++;for(var d=0;d<r.length&&m<=28;d++)if(cuenta3=r[d],"3"===cuenta3.tipoCuenta.nombre_corto){var b=String(cuenta3.codigo).substr(0,3);if(cuenta.codigo==b){if(t.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o})){i.text(cuenta3.nombre,40,s),cuenta3.total=0;for(var A=cuenta3.totalSus=0;A<t.length&&m<=28;A++)if(cuenta2=t[A],"4"===cuenta2.tipoCuenta.nombre_corto){b=String(cuenta2.codigo).substr(0,5);cuenta3.codigo==b&&(cuenta3.totalSus+=cuenta2.saldo/O.moneda.dolar,cuenta3.total+=cuenta2.saldo,cuenta.total+=cuenta2.saldo,p+=cuenta2.saldo),28==m&&(i.addPage({margin:0,bufferPages:!0}),s=140,m=0,l+=1,O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8))}else 28==m&&(i.addPage({margin:0,bufferPages:!0}),s=140,m=0,l+=1,O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8));O.configuracionImpresion.bimonetario&&i.text(number_format(cuenta3.totalSus,2),o+130,s),i.text(number_format(cuenta3.total,2),o,s),s+=20,m++}}else 28==m&&(i.addPage({margin:0,bufferPages:!0}),s=140,m=0,l+=1,O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8))}else 28==m&&(i.addPage({margin:0,bufferPages:!0}),s=140,m=0,l+=1,O.dibujarCabeceraPDFBalanceGeneral(i,l,f,"ACTIVO"),i.font("Helvetica",8));i.text("TOTAL "+cuenta.nombre,90,s),i.text(number_format(cuenta.total,2),o,s);var v=cuenta.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&i.text(number_format(v,2),o+130,s),s+=20,m++,g===a.length-1&&O.DibujarFijoPreestablecido(e,p,i,s,m,l,f,28,o)}else g===a.length-1&&O.DibujarFijoPreestablecido(e,p,i,s,m,l,f,28,o);O.configuracionImpresion.usar_firma_uno&&(i.text(O.configuracionImpresion.firma_uno,170,720),i.text(O.configuracionImpresion.cargo_uno,170,730)),O.configuracionImpresion.usar_firma_dos&&(i.text(O.configuracionImpresion.firma_dos,370,720),i.text(O.configuracionImpresion.cargo_dos,370,730)),i.end(),c.on("finish",function(){var e=c.toBlobURL("application/pdf");window.open(e,"_blank","location=no")}),_.stop()},O.generarPdfComprobantePreestablecido=function(e,o,n,a,r,t,i,c,u){var s=new PDFDocument({size:"letter",margin:10}),m=s.pipe(blobStream()),l=a.length+r.length,f=130,p=0,g=O.configuracionImpresion.usar_empesar_numeracion?O.configuracionImpresion.empesar_numeracion:1,d=O.configuracionImpresion.usar_empesar_numeracion?O.configuracionImpresion.empesar_numeracion-1+Math.ceil(l/28):Math.ceil(l/28),b={totalActivosPrimerAnio:0,totalActivosSegundoAnio:0};O.dibujarCabeceraPDFBalanceGeneral(s,g,d,"ACTIVO"),s.font("Helvetica",8);for(var A=0;A<a.length&&p<=28;A++)if(cuenta=a[A],cuenta.total=0,"Activo"===cuenta.primerAno.clasificacion.nombre){28==p&&(s.addPage({margin:0,bufferPages:!0}),f=140,p=0,g+=1,O.dibujarCabeceraPDFBalanceGeneral(s,g,d,"ACTIVO"),s.font("Helvetica",8)),s.text(cuenta.primerAno.nombre,30,f),cuenta.primerAno.total=0,cuenta.primerAno.totalSus=0,cuenta.segundoAno.total=0,f+=20,p++;for(var v=cuenta.segundoAno.totalSus=0;v<r.length&&p<=28;v++)if(cuenta3=r[v],"3"===cuenta3.primerAno.tipoCuenta.nombre_corto){var I=String(cuenta3.primerAno.codigo).substr(0,3);if(cuenta.primerAno.codigo==I){if(t.some(function(e){var o=String(e.primerAno.codigo).substr(0,5);return cuenta3.primerAno.codigo==o})){s.text(cuenta3.primerAno.nombre,40,f),cuenta3.primerAno.total=0,cuenta3.primerAno.totalSus=0,cuenta3.segundoAno.total=0;for(var P=cuenta3.segundoAno.totalSus=0;P<t.length&&p<=28;P++)if(cuenta2=t[P],"4"===cuenta2.primerAno.tipoCuenta.nombre_corto){I=String(cuenta2.primerAno.codigo).substr(0,5);cuenta3.primerAno.codigo==I&&(cuenta3.primerAno.totalSus+=cuenta2.primerAno.saldo/O.moneda.dolar,cuenta3.segundoAno.totalSus+=cuenta2.segundoAno.saldo/O.moneda.dolar,cuenta3.primerAno.total+=cuenta2.primerAno.saldo,cuenta.primerAno.total+=cuenta2.primerAno.saldo,cuenta3.segundoAno.total+=cuenta2.segundoAno.saldo,cuenta.segundoAno.total+=cuenta2.segundoAno.saldo,b.totalActivosPrimerAnio+=cuenta2.primerAno.saldo,b.totalActivosSegundoAnio+=cuenta2.segundoAno.saldo),28==p&&(s.addPage({margin:0,bufferPages:!0}),f=140,p=0,g+=1,O.dibujarCabeceraPDFBalanceGeneral(s,g,d,"ACTIVO"),s.font("Helvetica",8))}else 28==p&&(s.addPage({margin:0,bufferPages:!0}),f=140,p=0,g+=1,O.dibujarCabeceraPDFBalanceGeneral(s,g,d,"ACTIVO"),s.font("Helvetica",8));O.configuracionImpresion.bimonetario&&s.text(number_format(cuenta3.primerAno.totalSus,2),o+80,f),s.text(number_format(cuenta3.primerAno.total,2),o+180,f),O.configuracionImpresion.bimonetario&&s.text(number_format(cuenta3.segundoAno.totalSus,2),o+260,f),s.text(number_format(cuenta3.segundoAno.total,2),o,f),f+=20,p++}}else 28==p&&(s.addPage({margin:0,bufferPages:!0}),f=140,p=0,g+=1,O.dibujarCabeceraPDFBalanceGeneral(s,g,d,"ACTIVO"),s.font("Helvetica",8))}else 28==p&&(s.addPage({margin:0,bufferPages:!0}),f=140,p=0,g+=1,O.dibujarCabeceraPDFBalanceGeneral(s,g,d,"ACTIVO"),s.font("Helvetica",8));s.text("TOTAL "+cuenta.primerAno.nombre,90,f),s.text(number_format(cuenta.primerAno.total,2),o,f),s.text(number_format(cuenta.segundoAno.total,2),o+180,f);var h=cuenta.primerAno.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&s.text(number_format(h,2),o+80,f);h=cuenta.segundoAno.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&s.text(number_format(h,2),o+260,f),f+=20,p++,A===a.length-1&&O.DibujarFijoComparativoPreestablecido(e,b,s,f,p,g,d,28,o,n,a,r,t,i,c,u)}else A===a.length-1&&O.DibujarFijoComparativoPreestablecido(e,b,s,f,p,g,d,28,o,n,a,r,t,i,c,u);O.configuracionImpresion.usar_firma_uno&&(s.text(O.configuracionImpresion.firma_uno,170,720),s.text(O.configuracionImpresion.cargo_uno,170,730)),O.configuracionImpresion.usar_firma_dos&&(s.text(O.configuracionImpresion.firma_dos,370,720),s.text(O.configuracionImpresion.cargo_dos,370,730)),s.end(),m.on("finish",function(){var e=m.toBlobURL("application/pdf");window.open(e,"_blank","location=no")}),_.stop()},O.dibujarCabeceraPDFBalanceGeneral=function(e,o,n,a){if(e.font("Helvetica-Bold",8),e.text(O.usuario.empresa.razon_social,40,30,{width:220}),e.text("DE : ",40,40),e.text("NIT : ",40,50),e.text(O.usuario.empresa.direccion,40,60,{width:220}),e.text(O.usuario.empresa.nit,55,50),e.font("Helvetica-Bold",12),e.text("BALANCE GENERAL",0,75,{align:"center"}),e.font("Helvetica-Bold",8),"GES"==O.configuracionImpresion.tipoPeriodo.nombre_corto){var r=(new Date).getFullYear(),t=(new Date).getMonth(),i=new Date(r,t-1,0).getDate();O.configuracionImpresion.gestion.nombre<r?e.text("Al 31 de Diciembre de "+O.configuracionImpresion.gestion.nombre,0,85,{align:"center"}):e.text("Al "+i+" de "+O.meses[t].nombre+" de "+O.configuracionImpresion.gestion.nombre,0,85,{align:"center"})}else if("MES"==O.configuracionImpresion.tipoPeriodo.nombre_corto)e.text(O.configuracionImpresion.mes.nombre+" de "+O.configuracionImpresion.gestion.nombre,0,85,{align:"center"});else if("FECHAS"==O.configuracionImpresion.tipoPeriodo.nombre_corto){var c=new Date(O.convertirFecha(O.configuracionImpresion.fecha_inicio)),u=new Date(O.convertirFecha(O.configuracionImpresion.fecha_fin));e.text("Desde el "+c.getDate()+" de "+O.meses[c.getMonth()].nombre+" "+c.getFullYear()+" al "+u.getDate()+" de "+O.meses[u.getMonth()].nombre+" de "+u.getFullYear(),0,85,{align:"center"})}else"COMP"==O.configuracionImpresion.tipoPeriodo.nombre_corto&&e.text("Gesti√≥n "+O.configuracionImpresion.gestion.nombre+"- Gesti√≥n "+O.configuracionImpresion.gestion_fin.nombre,0,85,{align:"center"});O.configuracionImpresion.bimonetario?(e.text("Expresado en Bolivianos y D√≥lares",0,95,{align:"center"}),"COMPARATIVO"!=O.configuracionImpresion.tipoPeriodo.nombre?(e.text("Bolivianos",400,115),e.text("Dolares",520,115)):(e.text(O.configuracionImpresion.gestion.nombre,340,115),e.text("Bolivianos",290,125),e.text("Dolares",370,125),e.text(O.configuracionImpresion.gestion_fin.nombre,525,115),e.text("Bolivianos",473,125),e.text("Dolares",553,125))):e.text("Expresado en Bolivianos",0,95,{align:"center"}),e.text(a,0,105,{align:"center"}),"SAD"==O.configuracionImpresion.tipoNumeracion.nombre_corto?e.text("P√ÅGINA "+o,540,740):"SAI"==O.configuracionImpresion.tipoNumeracion.nombre_corto?e.text("P√ÅGINA "+o,0,740,{align:"center"}):"SSD"==O.configuracionImpresion.tipoNumeracion.nombre_corto?e.text("P√ÅGINA "+o,540,20):"PPD"==O.configuracionImpresion.tipoNumeracion.nombre_corto?e.text("P√ÅGINA "+o+" DE "+n,520,740):"PPC"==O.configuracionImpresion.tipoNumeracion.nombre_corto?e.text("P√ÅGINA "+o+" DE "+n,0,740,{align:"center"}):"PPSD"==O.configuracionImpresion.tipoNumeracion.nombre_corto&&e.text("P√ÅGINA "+o+" DE "+n,520,20),e.font("Helvetica",5),e.text(O.configuracionImpresion.usar_frase_pie_pagina?O.configuracionImpresion.frase_pie_pagina+", ":"",40,740),e.text((O.configuracionImpresion.usar_lugar_emision?O.configuracionImpresion.lugar_emision+", ":"")+(O.configuracionImpresion.usar_fecha_emision?O.fechaATexto(O.configuracionImpresion.fecha_emision):""),40,750)},O.generarExcelBalanceGeneral=function(e){c(O.configuracionImpresion,O.usuario.id_empresa).then(function(e){O.Cuentas=e.cuentas;for(var o=[["","","ESTADO CUENTAS PROVEEDOR"],["Deudor :"+proveedor.razon_social],["Fecha","N Recibo","Descripci√≥n","monto","total","total General"]],n=0,a=0;a<proveedor.compras.length;a++){var r=[];n+=proveedor.compras[a].saldo,proveedor.compras[a].fecha=new Date(proveedor.compras[a].fecha),r.push(proveedor.compras[a].fecha.getDate()+"/"+(proveedor.compras[a].fecha.getMonth()+1)+"/"+proveedor.compras[a].fecha.getFullYear()),r.push(proveedor.compras[a].id_movimiento),null==proveedor.compras[a].factura?r.push("PROFORMA"):r.push("factura : "+proveedor.compras[a].factura),r.push(proveedor.compras[a].saldo),r.push(n),r.push(n),o.push(r)}var t="SheetJS",i=new Workbook,c=sheet_from_array_of_arrays(o);i.SheetNames.push(t),i.Sheets[t]=c;var u=XLSX.write(i,{bookType:"xlsx",bookSST:!0,type:"binary"});saveAs(new Blob([s2ab(u)],{type:"application/octet-stream"}),"REPORTE-ESTADO-CUENTA-PROVEEDOR.xlsx"),_.stop()})},O.dibujarCabeceraExelBalanceGeneral=function(){var e="",o="";if("GES"==O.configuracionImpresion.tipoPeriodo.nombre_corto){var n=(new Date).getFullYear(),a=(new Date).getMonth(),r=new Date(n,a-1,0).getDate();e=O.configuracionImpresion.gestion.nombre<n?"Al 31 de Diciembre de "+O.configuracionImpresion.gestion.nombre:"Al "+r+" de "+O.meses[a].nombre+" de "+O.configuracionImpresion.gestion.nombre}else if("MES"==O.configuracionImpresion.tipoPeriodo.nombre_corto)e=O.configuracionImpresion.mes.nombre+" de "+O.configuracionImpresion.gestion.nombre;else if("FECHAS"==O.configuracionImpresion.tipoPeriodo.nombre_corto){var t=new Date(O.convertirFecha(O.configuracionImpresion.fecha_inicio)),i=new Date(O.convertirFecha(O.configuracionImpresion.fecha_fin));e="Desde el "+t.getDate()+" de "+O.meses[t.getMonth()].nombre+" "+t.getFullYear()+" al "+i.getDate()+" de "+O.meses[i.getMonth()].nombre+" de "+i.getFullYear()}else"COMP"==O.configuracionImpresion.tipoPeriodo.nombre_corto&&(e="Gesti√≥n "+O.configuracionImpresion.gestion.nombre+"- Gesti√≥n "+O.configuracionImpresion.gestion_fin.nombre);if(O.configuracionImpresion.bimonetario){o="Expresado en Bolivianos y D√≥lares";var c=["GRUPO","SUB GRUPO","GENERICO","APROPIACION","","BOLIVIANOS","","DOLARES"]}else{c=["GRUPO","SUB GRUPO","GENERICO","APROPIACION","","BOLIVIANOS"];o="Expresado en Bolivianos"}return[["","","","BALANCE GENERAL"],["","","",e],["","","",o],c]},O.generarExelApropiacion=function(e,o,n,a,r,t){for(var i=O.dibujarCabeceraExelBalanceGeneral(),c=0;c<a.length;c++){var u=[];if(cuenta=a[c],cuenta.total=0,"Activo"===cuenta.clasificacion.nombre){u.push(""),u.push(cuenta.nombre),i.push(u);for(var s=0;s<r.length;s++){u=[],cuenta3=r[s];var m=String(cuenta3.codigo).substr(0,3);if(cuenta.codigo==m&&t.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o})){u.push(""),u.push(""),u.push(cuenta3.nombre),i.push(u);for(var l=0;l<t.length;l++){u=[],cuenta2=t[l];m=String(cuenta2.codigo).substr(0,5);if(cuenta3.codigo==m){u.push(""),u.push(""),u.push(""),u.push(cuenta2.nombre),u.push(""),u.push(number_format(cuenta2.saldo,2));var f=cuenta2.saldo/O.moneda.dolar;O.configuracionImpresion.bimonetario&&u.push(""),u.push(number_format(f,2)),cuenta.total+=cuenta2.saldo,cuenta2.saldo,i.push(u)}}}}u=[],a.length}else a.length}O.configuracionImpresion.usar_firma_uno,O.configuracionImpresion.usar_firma_dos;var p="SheetJS",g=new Workbook,d=sheet_from_array_of_arrays(i);g.SheetNames.push(p),g.Sheets[p]=d;var b=XLSX.write(g,{bookType:"xlsx",bookSST:!0,type:"binary"});saveAs(new Blob([s2ab(b)],{type:"application/octet-stream"}),"REPORTE-BALANCE-GENERAL.xlsx"),_.stop()},O.descargarArchivo=function(e,a){var o=new FileReader;o.onload=function(e){var o=document.createElement("a");o.href=e.target.result,o.target="_blank",o.download=a||"archivo.dat";var n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});o.dispatchEvent(n),(window.URL||window.webkitURL).revokeObjectURL(o.href)},o.readAsDataURL(e)},O.dibujarCabeceraWordBalanceGeneral=function(){var e="",o="";if("GES"==O.configuracionImpresion.tipoPeriodo.nombre_corto){var n=(new Date).getFullYear(),a=(new Date).getMonth(),r=new Date(n,a-1,0).getDate();e=O.configuracionImpresion.gestion.nombre<n?"Al 31 de Diciembre de "+O.configuracionImpresion.gestion.nombre:"Al "+r+" de "+O.meses[a].nombre+" de "+O.configuracionImpresion.gestion.nombre}else if("MES"==O.configuracionImpresion.tipoPeriodo.nombre_corto)e=O.configuracionImpresion.mes.nombre+" de "+O.configuracionImpresion.gestion.nombre;else if("FECHAS"==O.configuracionImpresion.tipoPeriodo.nombre_corto){var t=new Date(O.convertirFecha(O.configuracionImpresion.fecha_inicio)),i=new Date(O.convertirFecha(O.configuracionImpresion.fecha_fin));e="Desde el "+t.getDate()+" de "+O.meses[t.getMonth()].nombre+" "+t.getFullYear()+" al "+i.getDate()+" de "+O.meses[i.getMonth()].nombre+" de "+i.getFullYear()}else"COMP"==O.configuracionImpresion.tipoPeriodo.nombre_corto&&(e="Gesti√≥n "+O.configuracionImpresion.gestion.nombre+"- Gesti√≥n "+O.configuracionImpresion.gestion_fin.nombre);if(O.configuracionImpresion.bimonetario){o="Expresado en Bolivianos y D√≥lares"}else{o="Expresado en Bolivianos"}return"\t\t\t\t\tBALANCE GENERAL\r\n\t\t\t\t\t"+e+"\r\n\t\t\t\t"+o+"\r\n"},O.generarWordApropiacion=function(e,o,n,a,r,t){var i=O.dibujarCabeceraWordBalanceGeneral(),c=[];c.push(i);O.dibujarCabeceraExelBalanceGeneral();for(var u=a.length+r.length+t.length,s=0,m=(O.configuracionImpresion.usar_empesar_numeracion&&O.configuracionImpresion.empesar_numeracion,O.configuracionImpresion.usar_empesar_numeracion?(O.configuracionImpresion.empesar_numeracion,Math.ceil(u/51)):Math.ceil(u/51),0);m<a.length&&s<=51;m++)if(cuenta=a[m],cuenta.total=0,"Activo"===cuenta.clasificacion.nombre){51==s&&(s=0,1,c.push(i)),c.push(cuenta.nombre+"\r\n"),s++;for(var l=0;l<r.length&&s<=51;l++){cuenta3=r[l];var f=String(cuenta3.codigo).substr(0,3);if(cuenta.codigo==f&&t.some(function(e){var o=String(e.codigo).substr(0,5);return cuenta3.codigo==o})){c.push("\t"),c.push(cuenta3.nombre+"\r\n"),51==++s&&(s=0,1,c.push(i));for(var p=0;p<t.length&&s<=51;p++){cuenta2=t[p];f=String(cuenta2.codigo).substr(0,5);if(cuenta3.codigo==f){c.push("\t\t"),22<cuenta2.nombre.length?(text1=String(cuenta2.nombre).substr(0,22),text2=String(cuenta2.nombre).substr(22),c.push(text1),c.push("\n\r\t\t"),s++,c.push(text2)):c.push(cuenta2.nombre),c.push("\t"),c.push(number_format(cuenta2.saldo,2));var g=cuenta2.saldo/O.moneda.dolar;O.configuracionImpresion.bimonetario&&c.push("\t\t"+number_format(g,2)),cuenta.total+=cuenta2.saldo,cuenta2.saldo,c.push("\r\n"),51==++s&&(s=0,1,c.push(i))}}}}c.push("\t"),c.push("TOTAL "+cuenta.nombre),c.push("\t\t\t\t"),c.push(number_format(cuenta.total,2));var d=cuenta.total/O.moneda.dolar;O.configuracionImpresion.bimonetario&&c.push("\t\t\t\t"),c.push(number_format(d,2)),a.length}else a.length;return O.configuracionImpresion.usar_firma_uno,O.configuracionImpresion.usar_firma_dos,_.stop(),new Blob(c,{type:"text/plain"})},O.$on("$routeChangeStart",function(e,o){}),O.generarPdfComprobanteDiario=function(){O.periodo=O.configuracionImpresion.tipoPeriodo.nombre,O.cuenta=O.configuracionImpresion.tipo_cuenta.nombre;var e=new Array(["Enero",1],["Febrero",2],["Marzo",3],["Abril",4],["Mayo",5],["Junio",6],["Julio",7],["Agosto",8],["Septiembre",9],["Octubre",10],["Noviembre",11],["Diciembre",12]);if(0==O.bimonetario)if("PREESTABLECIDO"===O.cuenta)if("GESTI√ìN"===O.periodo){var o=O.fechasImpresion.inicio,n=O.fechasImpresion.fin,a=O.configuracionImpresion.gestion.nombre;new Date(O.convertirFecha(o+"/"+a)),new Date(O.convertirFecha(n+"/"+a));console.log("DEBITO-RETENCION JUDICIAL, Gobierno Municipal de Cochabamba. Motivo (Impuestos de vehiculos realizados en cbba)".length)}else if("MES"===O.periodo){a=O.configuracionImpresion.gestion.nombre;for(var r=O.configuracionImpresion.mes.nombre,t=0;t<e.length;t++)r===e[t][0]&&(r=e[t][1]);var i=new Date(r+"/01/"+a),c=new Date(i.getFullYear(),i.getMonth(),1);(u=new Date(i.getFullYear(),i.getMonth()+1,0)).getDate();O.imprimirReportePDF(c,u)}else if("FECHAS"===O.periodo){c=new Date(O.convertirFecha(O.configuracionImpresion.fecha_inicio));var u=new Date(O.convertirFecha(O.configuracionImpresion.fecha_fin));O.imprimirReportePDF(c,u)}else"COMPARATIVO"===O.periodo&&O.mostrarMensaje("No es aplicable esta funcion.!");else O.mostrarMensaje("No se aplica a esta funcion");else O.mostrarMensaje("No se aplica la funcion bimonetaria al libro diario")},O.imprimirReportePDF=function(e,o){_.start();var n=O.usuario.empresa.id,a=s(n,e,o),b={};a.then(function(e){O.datosReporte=e.comprobantes;var o=O.datosReporte[0].sucursal.empresa.razon_social,n=O.datosReporte[0].sucursal.empresa.nit,a=O.datosReporte[0].sucursal.empresa.direccion;b={razon_social:o,nit:n,direccion:a};var r=new PDFDocument({compress:!1,margin:10}),t=r.pipe(blobStream());r.font("Helvetica",8);for(var i=180,c=0,u=1,s=0,m=0;m<O.datosReporte.length;m++)s+=O.datosReporte[m].asientosContables.length;var l=Math.ceil(s/22);O.dibujarCabeceraPDFReporteGestion(r,b,u,l);var f=1;for(m=0;m<O.datosReporte.length&&c<=22;m++){O.comprobante=O.datosReporte[m];var p=new Date(O.comprobante.fecha),g=p.getFullYear()+"/"+(p.getMonth()+1)+"/"+p.getDate();r.text(g,45,i),i+=10,r.text("- "+f+++" -",350,i);for(var d=0;d<O.comprobante.asientosContables.length&&c<=22;d++)O.asientoContable=O.comprobante.asientosContables[d],r.text(O.asientoContable.glosa,100,i,{width:220}),100<=O.asientoContable.glosa.length?(r.text("",100,i),0!=O.asientoContable.debe_bs?r.text(O.asientoContable.debe_bs,440,i):r.text(" ",440,i),0!=O.asientoContable.haber_bs?r.text(O.asientoContable.haber_bs,530,i):r.text(" ",530,i),i+=10):45<=O.asientoContable.glosa.length?(r.text("",100,i),0!=O.asientoContable.debe_bs?r.text(O.asientoContable.debe_bs,440,i):r.text(" ",440,i),0!=O.asientoContable.haber_bs?r.text(O.asientoContable.haber_bs,530,i):r.text(" ",530,i),i+=5):(0!=O.asientoContable.debe_bs?r.text(O.asientoContable.debe_bs,440,i):r.text(" ",440,i),0!=O.asientoContable.haber_bs?r.text(O.asientoContable.haber_bs,530,i):r.text(" ",530,i)),i+=17,22!=++c&&m+1!=O.datosReporte.length||m+1==O.datosReporte.length||(r.addPage({margin:0,bufferPages:!0}),i=180,c=0,u+=1,O.dibujarCabeceraPDFReporteGestion(r,b,u,l),r.font("Helvetica",8))}r.end(),t.on("finish",function(){var e=t.toBlobURL("application/pdf");window.open(e,"_blank","location=no")}),_.stop()})},O.dibujarCabeceraPDFReporteGestion=function(e,o,n,a){e.font("Helvetica-Bold",10),e.text(o.razon_social,45,70),e.font("Helvetica-Bold",10),e.text("NIT: "+o.nit,45,80),e.font("Helvetica-Bold",10),e.text("Calle: "+o.direccion,45,90,{width:350}),57<o.direccion.length?(e.font("Helvetica-Bold",10),e.text("Cochabamba - Bolivia",45,109)):(e.font("Helvetica-Bold",10),e.text("Cochabamba - Bolivia",45,100)),e.rect(43,67,400,47).stroke(),e.font("Helvetica-Bold",17),e.text("L√çBRO DIARIO",0,125,{align:"center"}),e.font("Helvetica-Bold",10),e.font("Helvetica-Bold",10),e.text("FECHA",45,150),e.font("Helvetica-Bold",10),e.text("T√çTULO DE LAS CUENTAS ",280,150),e.font("Helvetica-Bold",10),e.text("DEBE",430,150),e.font("Helvetica-Bold",10),e.text("HABER",520,150),e.font("Helvetica",8),e.text("Pagina "+n+" de "+a,500,750)},O.generarExcelComprobanteDiario=function(){O.periodo=O.configuracionImpresion.tipoPeriodo.nombre,O.cuenta=O.configuracionImpresion.tipo_cuenta.nombre;var e=new Array(["Enero",1],["Febrero",2],["Marzo",3],["Abril",4],["Mayo",5],["Junio",6],["Julio",7],["Agosto",8],["Septiembre",9],["Octubre",10],["Noviembre",11],["Diciembre",12]);if(0==O.bimonetario)if("PREESTABLECIDO"===O.cuenta)if("GESTI√ìN"===O.periodo){var o=O.fechasImpresion.inicio,n=O.fechasImpresion.fin,a=o+"/"+(t=O.configuracionImpresion.gestion.nombre),r=n+"/"+t;O.imprimirReporteExcel(a,r)}else if("MES"===O.periodo){for(var t=O.configuracionImpresion.gestion.nombre,i=O.configuracionImpresion.mes.nombre,c=0;c<e.length;c++)i===e[c][0]&&(i=e[c][1]);a=i+"/01/"+t;var u=new Date(a),s=new Date(u.getFullYear(),u.getMonth(),1);r=i+"/"+(m=new Date(u.getFullYear(),u.getMonth()+1,0)).getDate()+"/"+t;O.imprimirReporteExcel(s,m)}else if("FECHAS"===O.periodo){s=new Date(O.convertirFecha(O.configuracionImpresion.fecha_inicio));var m=new Date(O.convertirFecha(O.configuracionImpresion.fecha_fin));O.imprimirReporteExcel(s,m)}else"COMPARATIVO"===O.periodo&&O.mostrarMensaje("No es aplicable esta funcion.!");else O.mostrarMensaje("No se aplica a esta funcion");else O.mostrarMensaje("No se aplica la funcion bimonetaria al libro diario")},O.imprimirReporteExcel=function(e,o){_.start();var n=O.usuario.empresa.id;s(n,e,o).then(function(e){var o=e.comprobantes,n=[];n.push(["N¬∞ CUENTA","FECHA","TITULO DE LA CUENTA","DEBE","HABER"]);for(var a=0,r=0;r<o.length;r++){O.comprobante=o[r],a+=1;for(var t=0;t<O.comprobante.asientosContables.length;t++){O.asientoContable=O.comprobante.asientosContables[t];var i=[];i.push(a);var c=new Date(O.comprobante.fecha),u=c.getFullYear()+"/"+(c.getMonth()+1)+"/"+c.getDate();i.push(u),i.push(O.asientoContable.glosa),i.push(O.asientoContable.debe_bs),i.push(O.asientoContable.haber_bs),n.push(i)}}var s="SheetJS",m=new Workbook,l=sheet_from_array_of_arrays(n);m.SheetNames.push(s),m.Sheets[s]=l;var f=XLSX.write(m,{bookType:"xlsx",bookSST:!0,type:"binary"});saveAs(new Blob([s2ab(f)],{type:"application/octet-stream"}),"VENTAS-MENSUALES.xlsx"),_.stop()})},O.inicio()});